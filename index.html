<!doctype html><html lang="fr"><head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Guide Installation Médecin 360° - Elodia Tech</title>
  <script src="https://cdn.tailwindcss.com"></script>
  <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
  <script src="https://unpkg.com/@phosphor-icons/web"></script>
  <!-- Bibliothèques pour l'export PDF -->
  <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
  <script src="https://html2canvas.hertzen.com/dist/html2canvas.min.js"></script>
  
  <style>
    @import url('https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800;900&display=swap');
    
    * { margin: 0; padding: 0; box-sizing: border-box; }
    
    body {
      font-family: 'Inter', system-ui, -apple-system, sans-serif;
      background: linear-gradient(135deg, #f8fafc 0%, #e2e8f0 100%);
      color: #334155;
      min-height: 100vh;
      overflow-x: hidden;
    }

    /* Filigrane discret */
    body::before {
        content: ""; position: fixed; top: 50%; left: 50%; transform: translate(-50%, -50%);
        width: 600px; height: 469px;
        background-image: url('https://elodiatech.com/wp-content/uploads/2024/04/ELODIATECH-img-data-600x469.png');
        background-repeat: no-repeat; background-position: center; background-size: contain;
        opacity: 0.04; z-index: 0; pointer-events: none;
    }
    
    html { scroll-behavior: smooth; }
    
    .nav-glass {
      background: rgba(255, 255, 255, 0.95);
      backdrop-filter: blur(12px);
      box-shadow: 0 2px 15px rgba(0, 0, 0, 0.05);
      position: sticky; top: 0; z-index: 1000;
      border-bottom: 1px solid rgba(226, 232, 240, 0.8);
    }
    
    .hero-gradient {
      background: linear-gradient(135deg, #007BFF 0%, #0056b3 100%); /* Medical Blue */
      color: white; position: relative; z-index: 1; padding-bottom: 3rem;
    }

    /* TABS */
    .tabs-container {
        position: sticky; top: 72px; z-index: 900;
        background: rgba(248, 250, 252, 0.98);
        backdrop-filter: blur(10px);
        padding: 0.75rem 0; border-bottom: 1px solid #e2e8f0;
        margin-top: -2rem;
    }
    .nav-tabs {
        display: flex; 
        justify-content: flex-start; /* Changé pour éviter le rognage des onglets */
        gap: 0.5rem;
        overflow-x: auto; 
        padding-bottom: 0.2rem;
        padding-left: 1rem; /* Ajout padding mobile */
        padding-right: 1rem;
        -ms-overflow-style: none; 
        scrollbar-width: none;
    }
    .nav-tabs::-webkit-scrollbar { display: none; }

    .tab-btn {
        padding: 0.6rem 1rem; border-radius: 9999px;
        font-weight: 600; font-size: 0.85rem;
        color: #64748b; background: white; border: 1px solid #e2e8f0;
        transition: all 0.2s; white-space: nowrap; cursor: pointer;
        display: flex; align-items: center; gap: 6px;
        flex-shrink: 0; /* Empêche l'écrasement des boutons */
    }
    .tab-btn:hover { background: #f8fafc; color: #0f172a; border-color: #cbd5e1; transform: translateY(-1px); }
    .tab-btn.active { background: #007BFF; color: white; border-color: #007BFF; box-shadow: 0 4px 10px rgba(0, 123, 255, 0.3); }
    .tab-btn.calc-active { background: #28A745; color: white; border-color: #28A745; box-shadow: 0 4px 10px rgba(40, 167, 69, 0.3); }

    .tab-content { display: none; animation: fadeIn 0.4s ease-out; }
    .tab-content.active { display: block; }
    @keyframes fadeIn { from { opacity: 0; transform: translateY(10px); } to { opacity: 1; transform: translateY(0); } }
    
    .section-card {
        background: white; border-radius: 1rem; padding: 2rem;
        margin-bottom: 2rem; border-left: 4px solid #007BFF;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s;
    }
    .section-card:hover { transform: translateY(-2px); box-shadow: 0 10px 15px -3px rgba(0, 0, 0, 0.1); }

    /* Timeline */
    .timeline-item { position: relative; padding-left: 2.5rem; padding-bottom: 2.5rem; border-left: 2px solid #e2e8f0; }
    .timeline-item:last-child { border-left: transparent; }
    .timeline-badge {
        position: absolute; left: -0.65rem; top: 0; width: 1.3rem; height: 1.3rem;
        background: #007BFF; border: 3px solid white; border-radius: 50%; box-shadow: 0 0 0 2px #bfdbfe;
    }

    /* Calculator Specifics */
    .calc-input-group { margin-bottom: 1.5rem; }
    .calc-label { display: flex; justify-content: space-between; font-weight: 600; font-size: 0.85rem; color: #475569; margin-bottom: 0.5rem; }
    .calc-val { color: #007BFF; font-weight: 700; }
    
    input[type=range] { 
        -webkit-appearance: none; width: 100%; background: transparent; 
    }
    input[type=range]::-webkit-slider-thumb {
        -webkit-appearance: none; height: 20px; width: 20px; border-radius: 50%; background: #007BFF;
        cursor: pointer; margin-top: -8px; box-shadow: 0 2px 5px rgba(0,0,0,0.2); transition: background 0.2s;
    }
    input[type=range]::-webkit-slider-thumb:hover { background: #0056b3; }
    input[type=range]::-webkit-slider-runnable-track { 
        width: 100%; height: 4px; background: #e2e8f0; border-radius: 2px; 
    }

    .kpi-box {
        background: white; border-radius: 12px; padding: 1.5rem;
        border: 1px solid #e2e8f0; box-shadow: 0 4px 6px rgba(0,0,0,0.02);
        transition: transform 0.2s;
    }
    .kpi-box:hover { transform: translateY(-2px); border-color: #007BFF; }
    .kpi-title { font-size: 0.75rem; text-transform: uppercase; color: #64748b; font-weight: 700; letter-spacing: 0.05em; }
    .kpi-value { font-size: 1.75rem; font-weight: 800; color: #1e293b; margin-top: 0.25rem; }
    .kpi-sub { font-size: 0.8rem; font-weight: 600; }
    
    .text-medical-blue { color: #007BFF; }
    .bg-medical-blue { background-color: #007BFF; }
    .text-medical-green { color: #28A745; }
    .bg-medical-green { background-color: #28A745; }

    /* SCHEMA STYLES */
    .schema-box {
        padding: 1rem; border-radius: 0.75rem; text-align: center;
        box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.1); font-size: 0.85rem;
        position: relative; z-index: 10; transition: transform 0.2s;
    }
    .schema-box:hover { transform: scale(1.02); }
    .box-pro { background: #e1f5fe; border: 2px solid #01579b; color: #01579b; }
    .box-hold { background: #f3e5f5; border: 2px solid #4a148c; color: #4a148c; }
    .box-immo { background: #fff3e0; border: 2px solid #e65100; color: #e65100; }
    .box-dom { background: #e8f5e9; border: 2px dashed #1b5e20; color: #1b5e20; }
    
    /* Table Styles */
    .comp-table { width: 100%; border-collapse: collapse; font-size: 0.9rem; }
    .comp-table th { text-align: left; padding: 12px; background: #f8fafc; border-bottom: 2px solid #e2e8f0; color: #475569; font-weight: 700; }
    .comp-table td { padding: 12px; border-bottom: 1px solid #f1f5f9; color: #334155; }
    .comp-table tr:last-child td { border-bottom: none; font-weight: bold; background: #f0f9ff; }
    .positive-gain { color: #28A745; font-weight: bold; }
    
    /* Tree Styles Section 1 */
    .tree-connector { width: 2px; background: #e2e8f0; margin: 0 auto; min-height: 20px; }
    .tree-node { 
        background: white; border: 1px solid #cbd5e1; padding: 1rem; border-radius: 0.75rem; 
        text-align: center; width: 100%; position: relative; z-index: 10;
        transition: all 0.3s ease;
    }
    .tree-branch { display: flex; justify-content: space-between; position: relative; padding-top: 20px; }
    .tree-branch::before {
        content: ''; position: absolute; top: 0; left: 50%; width: 50%; height: 20px;
        border-top: 2px solid #e2e8f0; border-right: 2px solid #e2e8f0; border-radius: 0 10px 0 0;
    }
    .tree-branch::after {
        content: ''; position: absolute; top: 0; right: 50%; width: 50%; height: 20px;
        border-top: 2px solid #e2e8f0; border-left: 2px solid #e2e8f0; border-radius: 10px 0 0 0;
    }
    .tree-yes { color: #16a34a; font-weight: bold; font-size: 0.75rem; background: #dcfce7; padding: 2px 8px; border-radius: 10px; position: absolute; top: -10px; right: 20%; z-index: 20;}
    .tree-no { color: #dc2626; font-weight: bold; font-size: 0.75rem; background: #fee2e2; padding: 2px 8px; border-radius: 10px; position: absolute; top: -10px; left: 20%; z-index: 20;}

    /* Calculator Cards */
    .calculator-card {
        background: white; border-radius: 1rem; padding: 1.5rem;
        margin-bottom: 1.5rem; box-shadow: 0 4px 6px -1px rgba(0, 0, 0, 0.05);
        transition: transform 0.2s;
    }
    .calculator-card:hover { transform: translateY(-1px); }

    .input-label { 
        display: block; font-weight: 600; font-size: 0.8rem; 
        color: #475569; margin-bottom: 0.5rem; 
    }
    .input-field { 
        width: 100%; padding: 0.5rem; border: 1px solid #e2e8f0; 
        border-radius: 0.5rem; font-size: 0.85rem; 
        transition: border-color 0.2s;
    }
    .input-field:focus { outline: none; border-color: #007BFF; }

    .result-main-card {
        background: linear-gradient(135deg, #007BFF 0%, #0056b3 100%);
        color: white; padding: 2rem; border-radius: 1rem;
        text-align: center; box-shadow: 0 10px 25px rgba(0, 123, 255, 0.3);
    }
    .result-value { font-size: 2.5rem; font-weight: 900; }

    /* Checklist styles */
    .checklist-item {
        display: flex; align-items: start; gap: 0.75rem; padding: 1rem;
        background: white; border: 1px solid #e2e8f0; border-radius: 0.75rem;
        margin-bottom: 0.75rem; transition: all 0.2s; cursor: pointer;
    }
    .checklist-item:hover { border-color: #007BFF; transform: translateX(4px); }
    .checklist-icon { 
        width: 1.5rem; height: 1.5rem; border-radius: 50%; 
        display: flex; align-items: center; justify-content: center;
        font-size: 0.75rem; font-weight: bold; color: white;
        background: #94a3b8;
    }

    .progress-bar {
        width: 100%; height: 0.5rem; background: #e2e8f0; border-radius: 0.25rem;
        overflow: hidden; margin: 0.5rem 0;
    }
    .progress-fill {
        height: 100%; background: linear-gradient(90deg, #007BFF, #28A745);
        transition: width 0.3s ease;
    }

    .alert-box {
        padding: 1rem; border-radius: 0.75rem; margin: 1rem 0;
        border-left: 4px solid;
    }
    .alert-success { background: #f0fdf4; border-color: #22c55e; color: #166534; }
    .alert-warning { background: #fffbeb; border-color: #f59e0b; color: #92400e; }
    .alert-danger { background: #fef2f2; border-color: #ef4444; color: #991b1b; }
    .alert-info { background: #eff6ff; border-color: #3b82f6; color: #1e40af; }

    /* Responsive improvements */
    @media (max-width: 768px) {
        .calculator-card { padding: 1rem; }
        .result-value { font-size: 2rem; }
        .kpi-value { font-size: 1.5rem; }
    }
  </style></head><body class="text-slate-800 antialiased">
  <nav class="nav-glass">
    <div class="max-w-7xl mx-auto px-6 py-4 flex items-center justify-between">
      <div class="flex items-center gap-3">
        <img src="https://elodiatech.com/wp-content/uploads/2023/11/elodia-tech-LOGO-B-1536x1152.png" alt="Elodia" class="h-9 w-auto" onerror="this.style.display='none';">
        <div class="border-l border-slate-300 pl-3">
            <h1 class="text-base font-bold leading-none text-slate-800">Guide Installation 360°</h1>
            <p class="text-[10px] text-slate-500 uppercase tracking-wide font-semibold">Médecin Libéral</p>
        </div>
      </div>
      <div class="flex gap-3">
          <button onclick="switchTab('calculateur')" class="hidden md:block text-slate-600 font-medium text-sm hover:text-blue-600 transition">Simulateur 2025</button>
          <a href="https://elodiatech.com/formulaire-rendez-vous/" target="_blank" class="bg-blue-600 text-white px-5 py-2 rounded-full text-sm font-bold shadow-md hover:bg-blue-700 transition flex items-center gap-2">
              <i class="ph ph-paper-plane-right"></i> Contact
          </a>
      </div>
    </div>
  </nav>
  <div class="hero-gradient py-16 px-6 text-center">
    <h1 class="text-4xl md:text-6xl font-extrabold mb-4 tracking-tight">Installation Médecin <br class="hidden md:block"/>Guide 360 Degrés</h1>
    <p class="text-xl text-blue-100 mb-8 max-w-2xl mx-auto font-light">De la stratégie juridique au prévisionnel financier, maîtrisez chaque étape de votre installation libérale.</p>
    
    <!-- Indicateur de progression -->
    <div class="max-w-md mx-auto mt-8">
      <div class="flex justify-between text-sm text-blue-200 mb-2">
        <span>Progression du guide</span>
        <span id="progress-text">0%</span>
      </div>
      <div class="progress-bar">
        <div class="progress-fill" id="progress-fill" style="width: 0%"></div>
      </div>
    </div>
  </div>
  <div class="tabs-container">
      <div class="max-w-7xl mx-auto px-0 md:px-4">
          <div class="nav-tabs">
            <button onclick="switchTab('strategie')" id="btn-strategie" class="tab-btn active"><i class="ph ph-compass text-lg"></i> 1. Stratégie</button>
            <button onclick="switchTab('admin')" id="btn-admin" class="tab-btn"><i class="ph ph-files text-lg"></i> 2. Démarches</button>
            <button onclick="switchTab('pratique')" id="btn-pratique" class="tab-btn"><i class="ph ph-stethoscope text-lg"></i> 3. Pratique</button>
            <button onclick="switchTab('finance')" id="btn-finance" class="tab-btn"><i class="ph ph-trend-up text-lg"></i> 4. Aides & Finance</button>
            <button onclick="switchTab('vie')" id="btn-vie" class="tab-btn"><i class="ph ph-heartbeat text-lg"></i> 5. Carrière & Vie</button>
            <button onclick="switchTab('calculateur')" id="btn-calculateur" class="tab-btn text-indigo-700 border-indigo-200 bg-indigo-50 hover:bg-indigo-100 font-bold"><i class="ph ph-calculator text-lg"></i> 6. Simulateur 2025</button>
            <button onclick="switchTab('optimisation')" id="btn-optimisation" class="tab-btn text-purple-700 border-purple-200 bg-purple-50 hover:bg-purple-100 font-bold"><i class="ph ph-buildings text-lg"></i> 7. Optimisation Fiscale</button>
            <button onclick="switchTab('checklist')" id="btn-checklist" class="tab-btn text-green-700 border-green-200 bg-green-50 hover:bg-green-100 font-bold flex-shrink-0"><i class="ph ph-check-square text-lg"></i> 8. Checklist Interactive</button>
          </div>
      </div>
  </div>
  <main class="max-w-7xl mx-auto px-4 py-8 pb-20">
    <!-- TAB 1: STRATEGIE -->
    <div id="tab-strategie" class="tab-content active">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-10">
                <h2 class="text-3xl font-bold text-slate-800 mb-3">Définir son Projet Médical</h2>
                <p class="text-slate-600">Le choix du statut n'est pas qu'une question fiscale, c'est un choix de vie et de protection sociale.</p>
            </div>
            <!-- ARBRE DECISIONNEL -->
            <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200 mb-12 overflow-x-auto">
                <h3 class="text-center font-bold text-slate-700 mb-8 uppercase tracking-widest text-sm">Arbre Décisionnel : Quel Statut Choisir ?</h3>
                <div class="min-w-[600px] flex flex-col items-center">
                    <!-- Node 1 -->
                    <div class="tree-node max-w-xs border-blue-400 bg-blue-50">
                        <strong class="text-blue-800">Début d'activité ou CA modéré (< 100k€) ?</strong>
                    </div>
                    <div class="tree-connector h-8"></div>
                    <div class="w-full flex justify-center gap-16 relative">
                        <!-- Branch Left (OUI) -->
                        <div class="flex flex-col items-center w-1/2 relative">
                            <div class="tree-yes">OUI</div>
                            <div class="h-0.5 w-full bg-slate-200 absolute top-0 right-1/2"></div>
                            <div class="tree-connector h-4 absolute top-0"></div>
                            <div class="tree-node mt-4 border-green-400 bg-green-50 shadow-md">
                                <i class="ph ph-user text-2xl text-green-600 mb-2"></i>
                                <div class="font-bold text-green-800">EI / BNC</div>
                                <p class="text-xs text-slate-600 mt-1">Simplicité maximale. Charges réduites (~45%).</p>
                                <p class="text-[10px] text-slate-500 mt-1 italic">Option Micro-BNC si < 77k€</p>
                            </div>
                        </div>
                        <!-- Branch Right (NON) -->
                        <div class="flex flex-col items-center w-1/2 relative">
                            <div class="tree-no">NON</div>
                            <div class="h-0.5 w-full bg-slate-200 absolute top-0 left-1/2"></div>
                            <div class="tree-connector h-4 absolute top-0"></div>
                            <div class="tree-node mt-4">
                                <strong>Besoin de capitaliser (Trésorerie) ?</strong>
                            </div>
                            <div class="tree-connector h-6"></div>
                            <div class="w-full flex justify-center gap-4 relative">
                                <!-- Sub Branch Left -->
                                <div class="flex flex-col items-center w-1/2">
                                    <div class="tree-yes text-xs">OUI</div>
                                    <div class="h-0.5 w-full bg-slate-200 absolute top-0 right-1/2"></div>
                                    <div class="tree-connector h-4"></div>
                                    <div class="tree-node mt-4 border-indigo-400 bg-indigo-50 shadow-md">
                                        <i class="ph ph-buildings text-2xl text-indigo-600 mb-2"></i>
                                        <div class="font-bold text-indigo-800">SELARL</div>
                                        <p class="text-xs text-slate-600 mt-1">Écran Fiscal IS. Arbitrage Rémunération/Dividende.</p>
                                    </div>
                                </div>
                                <!-- Sub Branch Right -->
                                <div class="flex flex-col items-center w-1/2">
                                    <div class="tree-no text-xs">NON (Protection Max)</div>
                                    <div class="h-0.5 w-full bg-slate-200 absolute top-0 left-1/2"></div>
                                    <div class="tree-connector h-4"></div>
                                    <div class="tree-node mt-4 border-purple-400 bg-purple-50 shadow-md">
                                        <i class="ph ph-briefcase text-2xl text-purple-600 mb-2"></i>
                                        <div class="font-bold text-purple-800">SELAS</div>
                                        <p class="text-xs text-slate-600 mt-1">Statut Salarié. Retraite Régime Général. Charges élevées.</p>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- TABLEAU COMPARATIF STATUTS (NOUVEAU) -->
            <div class="mt-8 bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                <div class="p-4 bg-slate-50 border-b border-slate-200">
                    <h4 class="font-bold text-slate-700 flex items-center gap-2">
                        <i class="ph ph-table"></i> Comparatif Express des Statuts 2025
                    </h4>
                </div>
                <div class="overflow-x-auto">
                    <table class="w-full text-sm text-left text-slate-600">
                        <thead class="text-xs text-slate-700 uppercase bg-slate-50 border-b">
                            <tr>
                                <th class="px-6 py-3">Critère</th>
                                <th class="px-6 py-3 text-green-700 bg-green-50/50">EI / BNC</th>
                                <th class="px-6 py-3 text-indigo-700 bg-indigo-50/50">SELARL</th>
                                <th class="px-6 py-3 text-purple-700 bg-purple-50/50">SELAS</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">Charges Sociales</td>
                                <td class="px-6 py-4">~45% (Sur tout le bénéfice)</td>
                                <td class="px-6 py-4">~45% (Sur rémunération)</td>
                                <td class="px-6 py-4">~65-80% (Assimilé Salarié)</td>
                            </tr>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">Fiscalité</td>
                                <td class="px-6 py-4">IR (Progressif)</td>
                                <td class="px-6 py-4">IS (15%/25%) + IR sur Rémun.</td>
                                <td class="px-6 py-4">IS (15%/25%) + IR sur Rémun.</td>
                            </tr>
                            <tr class="bg-white border-b hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">Protection Sociale</td>
                                <td class="px-6 py-4">Moyenne (TNS)</td>
                                <td class="px-6 py-4">Moyenne (TNS)</td>
                                <td class="px-6 py-4">Forte (Régime Général - hors chômage)</td>
                            </tr>
                            <tr class="bg-white hover:bg-slate-50">
                                <td class="px-6 py-4 font-medium text-slate-900">Complexité Admin</td>
                                <td class="px-6 py-4">Faible</td>
                                <td class="px-6 py-4">Moyenne (Statuts, AG)</td>
                                <td class="px-6 py-4">Élevée (Fiches de paie, Statuts)</td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </div>

            <!-- CONSEIL EXPERT BOX (NOUVEAU) -->
            <div class="mt-6 bg-yellow-50 border-l-4 border-yellow-400 p-4 rounded-r-xl">
                <div class="flex items-start gap-3">
                    <i class="ph ph-lightbulb text-yellow-600 text-xl mt-1"></i>
                    <div>
                        <h5 class="font-bold text-yellow-800 text-sm">Le Conseil "Vie Privée"</h5>
                        <p class="text-xs text-yellow-700 mt-1">
                            Au-delà des chiffres, pensez à votre <strong>régime matrimonial</strong>. En SELARL/SELAS, la valeur des parts sociales peut entrer dans la communauté réduite aux acquêts. En cas de divorce, cela peut impacter votre cabinet. 
                            <br><em>Astuce : La séparation de biens est souvent recommandée pour les professions libérales en société.</em>
                        </p>
                    </div>
                </div>
            </div>

            <!-- DETAILED COMPARISON -->
            <div class="grid md:grid-cols-2 gap-8 mt-8">
                <div class="section-card border-l-emerald-500 !mb-0">
                    <h3 class="font-bold text-xl text-slate-800 mb-4 flex items-center gap-2">
                        <i class="ph ph-map-pin text-emerald-600"></i> Stratégie Territoriale
                    </h3>
                    <div class="space-y-4">
                        <div class="flex items-start gap-3 p-3 bg-white border border-slate-100 rounded-lg">
                            <div class="bg-emerald-100 text-emerald-600 rounded p-1"><i class="ph ph-warning-circle"></i></div>
                            <div>
                                <strong class="text-sm block text-slate-800">Zones ZIP (Sous-dotées)</strong>
                                <p class="text-xs text-slate-600">Avantage Cash immédiat. Aides conventionnelles (jusqu'à 50k€). Idéal pour financer l'investissement initial.</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3 p-3 bg-white border border-slate-100 rounded-lg">
                            <div class="bg-emerald-100 text-emerald-600 rounded p-1"><i class="ph ph-trend-up"></i></div>
                            <div>
                                <strong class="text-sm block text-slate-800">ZFU (Zone Franche Urbaine)</strong>
                                <p class="text-xs text-slate-600">Avantage Fiscal Long Terme. Exonération d'impôt sur les bénéfices (100% pendant 5 ans). Le levier le plus puissant pour constituer une trésorerie rapide.</p>
                            </div>
                        </div>
                        <div class="flex items-start gap-3 p-3 bg-white border border-slate-100 rounded-lg">
                            <div class="bg-emerald-100 text-emerald-600 rounded p-1"><i class="ph ph-sun"></i></div>
                            <div>
                                <strong class="text-sm block text-slate-800">DROM (Outre-Mer)</strong>
                                <p class="text-xs text-slate-600">Double avantage : Réduction d'Impôt sur le Revenu (30/40%) ET Exonération de charges sociales (LODEOM). Attention au coût de la vie.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <div class="section-card border-l-blue-500 !mb-0">
                    <h3 class="font-bold text-xl text-slate-800 mb-4 flex items-center gap-2">
                        <i class="ph ph-file-text text-blue-600"></i> Secteur Conventionnel
                    </h3>
                    <div class="bg-blue-50 p-4 rounded-lg mb-3">
                        <h4 class="font-bold text-blue-900 text-sm">Secteur 1 (Tarifs Sécu)</h4>
                        <p class="text-xs text-blue-800 mt-1">L'Assurance Maladie prend en charge une grande partie de vos cotisations sociales (Alloc. Familiales, Maladie). C'est un gain de ~10 points de charges.</p>
                    </div>
                    <div class="bg-white border border-blue-200 p-4 rounded-lg">
                        <h4 class="font-bold text-slate-800 text-sm">Secteur 2 (Honoraires Libres)</h4>
                        <p class="text-xs text-slate-600 mt-1">Vous fixez vos tarifs. En contrepartie, vous perdez la participation de la CPAM aux charges sociales. Nécessite une patientèle avec mutuelle adaptée.</p>
                        <div class="mt-2 text-xs bg-slate-100 p-2 rounded">
                            <strong>L'OPTAM :</strong> Le compromis. Vous modérez vos dépassements, et la CPAM vous rembourse une partie des cotisations.
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- TAB 2: DEMARCHES -->
    <div id="tab-admin" class="tab-content">
        <div class="max-w-5xl mx-auto">
            <h2 class="text-2xl font-bold text-slate-800 mb-6 text-center">Chronologie Détaillée : Ne manquez aucune étape</h2>
            
            <div class="grid md:grid-cols-2 gap-10">
                <div class="space-y-6">
                    <div class="bg-white p-5 rounded-xl border-l-4 border-blue-500 shadow-sm relative">
                        <div class="absolute -left-3 top-4 w-6 h-6 bg-blue-500 rounded-full text-white text-xs font-bold flex items-center justify-center">1</div>
                        <h3 class="font-bold text-slate-800">Le Conseil de l'Ordre (CDOM)</h3>
                        <span class="text-[10px] uppercase font-bold text-blue-500 tracking-wide">3 mois avant</span>
                        <p class="text-sm text-slate-600 mt-2">Étape fondatrice. Inscription obligatoire au tableau.</p>
                        <div class="mt-3 bg-slate-50 p-3 rounded text-xs text-slate-600 border border-slate-100">
                            <strong>Check-list Dossier :</strong>
                            <ul class="list-disc list-inside mt-1 space-y-1">
                                <li>Diplômes originaux (Doctorat + DES)</li>
                                <li>Contrats validés (Bail, SCM, Remplacement)</li>
                                <li>Extrait Casier Judiciaire n°3</li>
                                <li>Attestation de non-condamnation</li>
                            </ul>
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl border-l-4 border-emerald-500 shadow-sm relative">
                        <div class="absolute -left-3 top-4 w-6 h-6 bg-emerald-500 rounded-full text-white text-xs font-bold flex items-center justify-center">2</div>
                        <h3 class="font-bold text-slate-800">L'Assurance Maladie (CPAM)</h3>
                        <span class="text-[10px] uppercase font-bold text-emerald-500 tracking-wide">1 mois avant</span>
                        <p class="text-sm text-slate-600 mt-2">Enregistrement de votre activité avec l'attestation ordinale.</p>
                        <div class="mt-3 bg-emerald-50 p-3 rounded text-xs text-emerald-800 border border-emerald-100">
                            <strong>Documents à fournir :</strong>
                            <ul class="list-disc list-inside mt-1">
                                <li>Attestation d'inscription au tableau de l'Ordre.</li>
                                <li>RIB Personnel (BNC) ou Professionnel (Société).</li>
                                <li>Carte d'identité.</li>
                            </ul>
                        </div>
                    </div>
                </div>
                <div class="space-y-6">
                    <div class="bg-white p-5 rounded-xl border-l-4 border-orange-500 shadow-sm relative">
                        <div class="absolute -left-3 top-4 w-6 h-6 bg-orange-500 rounded-full text-white text-xs font-bold flex items-center justify-center">3</div>
                        <h3 class="font-bold text-slate-800">Guichet Unique (INPI) & URSSAF</h3>
                        <span class="text-[10px] uppercase font-bold text-orange-500 tracking-wide">J-0 à J+8</span>
                        <p class="text-sm text-slate-600 mt-2">Déclaration unique d'activité. C'est ici que vous obtenez votre SIRET.</p>
                        <div class="mt-2 bg-orange-50 p-3 rounded border border-orange-100 text-xs text-orange-900">
                            <strong>Attention aux délais !</strong> L'immatriculation doit se faire impérativement dans les 8 jours suivant le début d'activité pour éviter les pénalités.
                        </div>
                    </div>
                    <div class="bg-white p-5 rounded-xl border-l-4 border-red-500 shadow-sm relative">
                        <div class="absolute -left-3 top-4 w-6 h-6 bg-red-500 rounded-full text-white text-xs font-bold flex items-center justify-center">4</div>
                        <h3 class="font-bold text-slate-800">Sécurisation (RCP & CARMF)</h3>
                        <span class="text-[10px] uppercase font-bold text-red-500 tracking-wide">Impératif avant 1er patient</span>
                        <p class="text-sm text-slate-600 mt-2">Ne jamais débuter sans couverture Responsabilité Civile Professionnelle.</p>
                        <div class="mt-3 bg-red-50 p-3 rounded text-xs text-red-800 border border-red-100">
                            <strong>CARMF (Retraite) :</strong> L'affiliation est obligatoire dans le mois qui suit le début d'exercice. Pensez à envoyer votre déclaration de revenus estimés.
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="mt-8 bg-slate-800 text-white p-6 rounded-xl shadow-lg">
                <h3 class="font-bold text-lg mb-4 flex items-center gap-2"><i class="ph ph-warning-octagon text-yellow-400 text-2xl"></i> Les 3 Pièges à Éviter Absolument</h3>
                <div class="grid md:grid-cols-3 gap-6">
                    <div>
                        <strong class="text-yellow-400 text-sm block mb-1">1. Oublier la RCP</strong>
                        <p class="text-xs text-slate-300">Exercer sans assurance est illégal et vous expose personnellement en cas de litige patient. La couverture doit être active au Jour J.</p>
                    </div>
                    <div>
                        <strong class="text-yellow-400 text-sm block mb-1">2. Le Compte Bancaire Mixte</strong>
                        <p class="text-xs text-slate-300">Même en EI, n'utilisez jamais votre compte personnel courant. Ouvrez un compte dédié pour isoler les flux et simplifier la comptabilité.</p>
                    </div>
                    <div>
                        <strong class="text-yellow-400 text-sm block mb-1">3. Négliger la Prévoyance</strong>
                        <p class="text-xs text-slate-300">La CARMF ne couvre pas les 90 premiers jours d'arrêt maladie. Sans prévoyance privée, un pépin de santé = 0€ de revenu.</p>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- TAB 3: PRATIQUE -->
    <div id="tab-pratique" class="tab-content">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-2xl font-bold text-slate-800 mb-2">Concevoir & Sécuriser son Cabinet</h2>
            <p class="text-slate-600 mb-8">Au-delà du soin : normes techniques, sécurité des données et spécificités locales.</p>
            
            <div class="grid lg:grid-cols-3 gap-6 mb-6">
                <!-- SCHÉMA CABINET TYPE -->
                <div class="lg:col-span-2 bg-white rounded-xl border border-slate-200 p-6 shadow-sm">
                    <h3 class="font-bold text-indigo-700 mb-4 flex items-center gap-2"><i class="ph ph-blueprint text-xl"></i> Zoning & Surfaces Recommandées</h3>
                    <div class="grid grid-cols-2 gap-4 h-64">
                        <div class="bg-indigo-50 rounded-lg p-4 flex flex-col justify-between border border-indigo-100 relative">
                            <div class="absolute top-2 right-2 text-[10px] bg-white px-2 rounded border border-indigo-200 text-indigo-600 font-bold">Min 15-20 m²</div>
                            <span class="font-bold text-indigo-900"><i class="ph ph-armchair"></i> Salle d'Attente</span>
                            <p class="text-xs text-indigo-700">Flux patient. Isolation phonique (Cloisons 45dB). Affichages. Coin enfants.</p>
                        </div>
                        <div class="bg-slate-50 rounded-lg p-4 flex flex-col justify-between border border-slate-200 relative">
                            <div class="absolute top-2 right-2 text-[10px] bg-white px-2 rounded border border-slate-300 text-slate-600 font-bold">Stratégique</div>
                            <span class="font-bold text-slate-700"><i class="ph ph-user-focus"></i> Secrétariat / Accueil</span>
                            <p class="text-xs text-slate-600">Filtre entrée. Confidentialité visuelle et sonore des appels. Stockage dossiers.</p>
                        </div>
                        <div class="bg-emerald-50 rounded-lg p-4 flex flex-col justify-between border border-emerald-100 col-span-2 relative">
                            <div class="absolute top-2 right-2 text-[10px] bg-white px-2 rounded border border-emerald-200 text-emerald-600 font-bold">Min 17 m²</div>
                            <div class="flex justify-between">
                                <span class="font-bold text-emerald-900"><i class="ph ph-stethoscope"></i> Salle de Consultation & Soins</span>
                                <span class="text-xs bg-white px-2 py-1 rounded text-emerald-800 font-bold">Zone Confidentielle</span>
                            </div>
                            <div class="grid grid-cols-2 gap-4 mt-2">
                                <div class="bg-white/60 p-2 rounded text-xs text-emerald-800">
                                    <strong>Bureau :</strong> Ordi, Lecteur CV, Imprimante. Face au patient. Éclairage > 300 lux.
                                </div>
                                <div class="bg-white/60 p-2 rounded text-xs text-emerald-800">
                                    <strong>Examen :</strong> Divan, Guéridon, Point d'eau (Commande fémorale/électronique).
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
                
                <!-- NORMES & MATERIEL -->
                <div class="space-y-4">
                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-800 mb-2 flex items-center gap-2"><i class="ph ph-wheelchair text-blue-600"></i> Normes ERP 5 (PMR)</h4>
                        <ul class="text-xs text-slate-600 list-disc list-inside space-y-1">
                            <li><strong>Portes :</strong> Largeur utile 90cm min.</li>
                            <li><strong>Sanitaires :</strong> Aire de rotation 1.50m.</li>
                            <li><strong>Rampe :</strong> Pente max 5% si dénivelé.</li>
                            <li><strong>Registre :</strong> Registre public d'accessibilité à l'accueil.</li>
                        </ul>
                    </div>
                    <div class="bg-white p-5 rounded-xl border border-slate-200 shadow-sm">
                        <h4 class="font-bold text-slate-800 mb-2 flex items-center gap-2"><i class="ph ph-fire-extinguisher text-red-600"></i> Sécurité Incendie</h4>
                        <ul class="text-xs text-slate-600 list-disc list-inside space-y-1">
                            <li><strong>Extincteur :</strong> 1 pour 300m² (Eau pulvérisée + Additif).</li>
                            <li><strong>Vérification :</strong> Annuelle (Q4).</li>
                            <li><strong>Alarme :</strong> Type 4 (sifflet ou électrique) selon config.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- NOUVEAU BLOC : SPECIFICITÉS TROPICALES & IT -->
            <div class="grid md:grid-cols-3 gap-6 mb-6">
                <div class="bg-orange-50 border border-orange-200 rounded-xl p-4">
                    <h4 class="font-bold text-orange-900 mb-2 flex items-center gap-2"><i class="ph ph-sun-horizon"></i> Climat & Bâti (DROM)</h4>
                    <ul class="text-xs text-orange-800 space-y-2">
                        <li class="flex items-start gap-2"><i class="ph ph-fan mt-0.5"></i> <span><strong>Climatisation :</strong> Contrat d'entretien semestriel (Filtres/Moisissures).</span></li>
                        <li class="flex items-start gap-2"><i class="ph ph-drop mt-0.5"></i> <span><strong>Eau :</strong> Citerne tampon recommandée (Coupures).</span></li>
                        <li class="flex items-start gap-2"><i class="ph ph-wind mt-0.5"></i> <span><strong>Cyclone :</strong> Volets cycloniques ou vitrage feuilleté.</span></li>
                    </ul>
                </div>
                <div class="bg-blue-50 border border-blue-200 rounded-xl p-4">
                    <h4 class="font-bold text-blue-900 mb-2 flex items-center gap-2"><i class="ph ph-wifi-high"></i> Continuité IT</h4>
                    <ul class="text-xs text-blue-800 space-y-2">
                        <li class="flex items-start gap-2"><i class="ph ph-lightning mt-0.5"></i> <span><strong>Électrique :</strong> Onduleur obligatoire (Protection matériel & coupures).</span></li>
                        <li class="flex items-start gap-2"><i class="ph ph-cell-signal-full mt-0.5"></i> <span><strong>Internet :</strong> Routeur 4G de secours (Failover) pour télétrans.</span></li>
                        <li class="flex items-start gap-2"><i class="ph ph-shield-network mt-0.5"></i> <span><strong>Wi-Fi :</strong> Réseau "Invité" séparé du réseau "Médical".</span></li>
                    </ul>
                </div>
                <div class="bg-slate-50 border border-slate-200 rounded-xl p-4">
                    <h4 class="font-bold text-slate-800 mb-2 flex items-center gap-2"><i class="ph ph-speaker-slash"></i> Confort & Acoustique</h4>
                    <p class="text-xs text-slate-600 mb-2">La confidentialité est une obligation légale.</p>
                    <ul class="text-xs text-slate-600 list-disc list-inside space-y-1">
                        <li><strong>Cloisons :</strong> Isolation 45dB (Placo phonique).</li>
                        <li><strong>Portes :</strong> Pleines, avec joints isophoniques (balais).</li>
                        <li><strong>Musique :</strong> Fond sonore en salle d'attente (masquage).</li>
                    </ul>
                </div>
            </div>

            <!-- MODULE CONFORMITE RGPD & DECHETS -->
            <div class="grid md:grid-cols-2 gap-6">
                <div class="bg-white border border-slate-200 rounded-xl p-5 shadow-sm">
                    <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2"><i class="ph ph-lock-key text-xl text-slate-600"></i> Conformité RGPD & Données</h3>
                    <ul class="space-y-2 text-xs">
                        <li class="flex items-start gap-2">
                            <i class="ph ph-check text-green-600 mt-0.5"></i>
                            <span><strong>Sauvegarde HDS :</strong> Vos données patients DOIVENT être hébergées chez un Hébergeur de Données de Santé certifié.</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="ph ph-check text-green-600 mt-0.5"></i>
                            <span><strong>Messagerie MSSanté :</strong> Interdiction d'envoyer des données patients via Gmail/Yahoo. Utilisez Mailiz ou Apicrypt.</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="ph ph-check text-green-600 mt-0.5"></i>
                            <span><strong>Information Patient :</strong> Affichage en salle d'attente sur le traitement des données informatiques.</span>
                        </li>
                    </ul>
                </div>
                <div class="bg-white border border-slate-200 rounded-xl p-5 shadow-sm">
                    <h3 class="font-bold text-slate-800 mb-3 flex items-center gap-2"><i class="ph ph-trash text-xl text-slate-600"></i> Gestion des Déchets (DASRI)</h3>
                    <ul class="space-y-2 text-xs">
                        <li class="flex items-start gap-2">
                            <i class="ph ph-check text-green-600 mt-0.5"></i>
                            <span><strong>Contenants :</strong> Boîtes jaunes normalisées pour les aiguilles (OPCT).</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="ph ph-check text-green-600 mt-0.5"></i>
                            <span><strong>Collecte :</strong> Contrat obligatoire avec un prestataire agréé (ex: 72h max si > 5kg/mois).</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="ph ph-check text-green-600 mt-0.5"></i>
                            <span><strong>Traçabilité :</strong> Conservez les bordereaux de suivi d'élimination des déchets (3 ans).</span>
                        </li>
                    </ul>
                </div>
            </div>
        </div>
    </div>
    <!-- TAB 4: FINANCE -->
    <div id="tab-finance" class="tab-content">
        <div class="max-w-6xl mx-auto">
            <h2 class="text-2xl font-bold text-slate-800 mb-6 flex items-center gap-2">
                <i class="ph ph-coins text-yellow-500"></i> Aides Financières & Dispositifs
            </h2>
            
            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div class="bg-white p-6 rounded-xl border-l-4 border-blue-500 shadow-sm">
                    <h3 class="font-bold text-blue-900 mb-3 flex items-center gap-2"><i class="ph ph-map-pin text-xl"></i> Aides Zonées (ARS / CPAM)</h3>
                    <ul class="space-y-3 text-sm text-slate-700">
                        <li class="border-b border-slate-100 pb-2">
                            <strong>CAIM (Contrat d'Aide à l'Installation) :</strong> Jusqu'à <span class="text-green-600 font-bold">50 000 €</span> versés (50% à l'installation, 50% à +1 an) pour une installation en Zone d'Intervention Prioritaire (ZIP).
                        </li>
                        <li class="border-b border-slate-100 pb-2">
                            <strong>COSCOM (Contrat de Solidarité) :</strong> Majoration de 10% sur les honoraires pour les médecins exerçant en groupe ou MSP dans les zones fragiles (Hors ZIP, ou en complément).
                        </li>
                        <li>
                            <strong>PTMG (Praticien Territorial) :</strong> Garantie de revenus pendant 2 ans (idéal pour sécuriser un début d'activité incertain).
                        </li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-xl border-l-4 border-purple-500 shadow-sm">
                    <h3 class="font-bold text-purple-900 mb-3 flex items-center gap-2"><i class="ph ph-chart-bar text-xl"></i> Primes à la Performance</h3>
                    <ul class="space-y-3 text-sm text-slate-700">
                        <li class="border-b border-slate-100 pb-2">
                            <strong>Forfait Médecin Traitant (FMT) :</strong> Rémunération forfaitaire pour le suivi de la patientèle (5€ à 70€/patient/an), versée chaque trimestre.
                        </li>
                        <li class="border-b border-slate-100 pb-2">
                            <strong>Forfait Structure :</strong> Aide annuelle pour la modernisation (Logiciel Ségur, Messagerie sécurisée, Videoconsultation). <br><span class="text-xs text-slate-500">Montant moyen : 4 000 - 9 000 € / an.</span>
                        </li>
                        <li class="border-b border-slate-100 pb-2">
                            <strong>ROSP (Objectifs Santé Publique) :</strong> Prime sur le suivi des patients chroniques, prévention et efficience des prescriptions.
                        </li>
                        <li>
                            <strong>Aide à l'Embauche d'Assistant Médical :</strong> Financement pérenne du poste pour libérer du temps médical (jusqu'à 36k€ la 1ère année).
                        </li>
                    </ul>
                </div>
            </div>
            
            <!-- NOUVEAU BLOC : SPÉCIFICITÉS FISCALES & BANCAIRES -->
            <div class="grid md:grid-cols-3 gap-6">
                <div class="bg-green-50 p-5 rounded-xl border border-green-200">
                    <h4 class="font-bold text-green-900 mb-2 flex items-center gap-2"><i class="ph ph-tree text-lg"></i> Fiscalité & ZFU</h4>
                    <p class="text-xs text-green-800 mb-2">Leviers fiscaux puissants en Martinique.</p>
                    <ul class="text-xs text-green-700 list-disc list-inside space-y-1">
                        <li><strong>ZFU (Impôt Bénéfice) :</strong> Exonération 100% pendant 5 ans (Plafond 50k€/an).</li>
                        <li><strong>CFE (Impôt Locaux) :</strong> Exonération totale la 1ère année d'exercice. Exonération prolongée possible en ZFU/QPV (sur délibération locale).</li>
                        <li><strong>TVA :</strong> Franchise en base (pas de TVA à facturer sur les soins).</li>
                    </ul>
                </div>
                <div class="bg-orange-50 p-5 rounded-xl border border-orange-200">
                    <h4 class="font-bold text-orange-900 mb-2 flex items-center gap-2"><i class="ph ph-bank text-lg"></i> Stratégie Bancaire</h4>
                    <p class="text-xs text-orange-800 mb-2">Financer le BFR et le matériel.</p>
                    <ul class="text-xs text-orange-700 list-disc list-inside space-y-1">
                        <li><strong>Prêt Installation :</strong> Financez votre BFR (Besoin en Fonds de Roulement) pour les 3-6 premiers mois.</li>
                        <li><strong>Crédit-Bail (LOA) :</strong> Privilégiez le leasing pour le matériel médical (déductible intégralement en charge).</li>
                        <li><strong>Assurance Emprunteur :</strong> Négociez une délégation d'assurance (loi Lemoine) pour réduire le coût.</li>
                    </ul>
                </div>
                <div class="bg-red-50 p-5 rounded-xl border border-red-200">
                    <h4 class="font-bold text-red-900 mb-2 flex items-center gap-2"><i class="ph ph-shield-check text-lg"></i> Social & Embauche</h4>
                    <p class="text-xs text-red-800 mb-2">Alléger le coût du travail.</p>
                    <ul class="text-xs text-red-700 list-disc list-inside space-y-1">
                        <li><strong>LODEOM (Social) :</strong> Exonération de charges patronales sur les salaires jusqu'à 2.5 SMIC (Idéal secrétaire).</li>
                        <li><strong>Prévoyance Madelin :</strong> Indispensable pour couvrir les frais fixes du cabinet en cas d'arrêt de travail.</li>
                        <li><strong>TESE (URSSAF) :</strong> Dispositif simplifié pour gérer la paie d'un salarié sans expert-comptable.</li>
                    </ul>
                </div>
            </div>
            
            <!-- ALERT BOX CTM (NOUVEAU) -->
            <div class="mt-6 bg-slate-50 border border-slate-200 p-4 rounded-xl flex gap-3 items-start">
                <i class="ph ph-info text-blue-500 text-xl mt-0.5"></i>
                <div>
                    <h5 class="font-bold text-slate-800 text-sm">Aides Régionales (CTM)</h5>
                    <p class="text-xs text-slate-600 mt-1">
                        La Collectivité Territoriale de Martinique (CTM) propose ponctuellement des aides à l'investissement numérique ou à la modernisation des cabinets de santé. 
                        Renseignez-vous auprès de la CTM ou de l'URPS Médecins Martinique pour les appels à projets en cours.
                    </p>
                </div>
            </div>
        </div>
    </div>
    <!-- TAB 5: CARRIERE & VIE -->
    <div id="tab-vie" class="tab-content">
        <div class="max-w-6xl mx-auto">
            
            <div class="flex justify-between items-center mb-6">
                <h2 class="text-2xl font-bold text-slate-800 flex items-center gap-2">
                    <i class="ph ph-heartbeat text-red-500"></i> Protection Sociale & Carrière Médicale
                </h2>
                <!-- No Partner Logo here as requested -->
            </div>
            
            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <!-- RETRAITE CARMF -->
                <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-md">
                    <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="ph ph-hourglass-high text-blue-600"></i> La Retraite (CARMF)</h3>
                    <p class="text-sm text-slate-600 mb-4">Obligatoire pour tous les médecins libéraux. Elle se compose de 3 régimes distincts :</p>
                    
                    <div class="space-y-4">
                        <div class="flex gap-3">
                            <div class="min-w-[30px] h-[30px] bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold text-xs">1</div>
                            <div>
                                <h4 class="text-sm font-bold text-slate-700">Régime de Base (CNAVPL)</h4>
                                <p class="text-xs text-slate-500">Proportionnel au revenu. Donne des points.</p>
                            </div>
                        </div>
                        <div class="flex gap-3">
                            <div class="min-w-[30px] h-[30px] bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold text-xs">2</div>
                            <div>
                                <h4 class="text-sm font-bold text-slate-700">Régime Complémentaire (RC)</h4>
                                <p class="text-xs text-slate-500">Le plus important. Cotisation forfaitaire + proportionnelle.</p>
                            </div>
                        </div>
                        <div class="flex gap-3">
                            <div class="min-w-[30px] h-[30px] bg-blue-100 text-blue-600 rounded-full flex items-center justify-center font-bold text-xs">3</div>
                            <div>
                                <h4 class="text-sm font-bold text-slate-700">ASV (Avantage Social Vieillesse)</h4>
                                <p class="text-xs text-slate-500">Spécifique aux médecins conventionnés.</p>
                            </div>
                        </div>
                    </div>
                </div>
                <!-- MATERNITE / PATERNITE -->
                <div class="space-y-6">
                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-md">
                        <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="ph ph-baby text-pink-500"></i> Parentalité & Famille</h3>
                        
                        <div class="mb-4">
                            <h4 class="text-sm font-bold text-pink-600 mb-1">Congé Maternité</h4>
                            <ul class="text-sm text-slate-700 space-y-1 list-disc list-inside">
                                <li><strong>Durée :</strong> 16 semaines (6 avt / 10 apr).</li>
                                <li><strong>Indemnités :</strong> Allocation forfaitaire (~3600€) + IJ (~56€/j).</li>
                                <li><strong>ASM :</strong> Aide sup. Secteur 1 pour remplacement.</li>
                            </ul>
                        </div>
                        <div class="pt-4 border-t border-slate-100">
                            <h4 class="text-sm font-bold text-blue-600 mb-1">Congé Paternité</h4>
                            <ul class="text-sm text-slate-700 space-y-1 list-disc list-inside">
                                <li><strong>Durée :</strong> 25 jours (dont 4 obligatoires) + 3 jours naissance.</li>
                                <li><strong>Indemnités :</strong> IJ journalières (~56€/j) sous condition de cessation d'activité.</li>
                                <li><strong>Flexibilité :</strong> Fractionnable en 2 périodes.</li>
                            </ul>
                        </div>
                    </div>
                    <!-- EXERCICES COMPLEMENTAIRES -->
                    <div class="bg-white p-6 rounded-xl border border-slate-200 shadow-md">
                        <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="ph ph-hospital text-teal-500"></i> Diversification & Exercice Mixte</h3>
                        <p class="text-sm text-slate-600 mb-2">Ne vous limitez pas au cabinet. Diversifiez pour rompre l'isolement et sécuriser vos revenus.</p>
                        <ul class="text-sm text-slate-700 space-y-2">
                            <li><strong class="text-teal-700">EHPAD :</strong> Médecin Coordonnateur ou Traitant. Revenu salarié ou libéral.</li>
                            <li><strong class="text-teal-700">MSP (Maison de Santé) :</strong> Travail en équipe, partage de SISA, primes NMR.</li>
                            <li><strong class="text-teal-700">Centre de Santé :</strong> Salariat pur, gestion allégée.</li>
                        </ul>
                    </div>
                </div>
            </div>

            <!-- NOUVEAU BLOC : FORMATION & SANTÉ DU SOIGNANT -->
            <div class="grid md:grid-cols-2 gap-8 mb-8">
                <div class="bg-yellow-50 p-6 rounded-xl border border-yellow-200">
                    <h3 class="font-bold text-yellow-900 mb-3 flex items-center gap-2"><i class="ph ph-graduation-cap text-xl"></i> Formation Continue (DPC)</h3>
                    <p class="text-xs text-yellow-800 mb-3">Obligation triennale de Développement Professionnel Continu.</p>
                    <ul class="text-sm text-yellow-900 space-y-2">
                        <li class="flex items-start gap-2">
                            <i class="ph ph-check-circle mt-1"></i>
                            <span><strong>Indemnisation :</strong> L'ANDPC vous indemnise pour perte de revenus pendant la formation (hors congrès).</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="ph ph-check-circle mt-1"></i>
                            <span><strong>Crédit d'impôt :</strong> Jusqu'à 40h de formation par an déductibles en crédit d'impôt dirigeant.</span>
                        </li>
                    </ul>
                </div>
                <div class="bg-pink-50 p-6 rounded-xl border border-pink-200">
                    <h3 class="font-bold text-pink-900 mb-3 flex items-center gap-2"><i class="ph ph-first-aid text-xl"></i> Santé du Soignant</h3>
                    <p class="text-xs text-pink-800 mb-3">"Qui soigne le soignant ?" - Ne restez pas isolé.</p>
                    <ul class="text-sm text-pink-900 space-y-2">
                        <li class="flex items-start gap-2">
                            <i class="ph ph-heart mt-1"></i>
                            <span><strong>Médecin Traitant :</strong> 80% des médecins n'en ont pas. Déclarez-en un hors cercle familial.</span>
                        </li>
                        <li class="flex items-start gap-2">
                            <i class="ph ph-phone-call mt-1"></i>
                            <span><strong>Entraide Ordinale :</strong> Numéro vert gratuit 24/7 en cas d'épuisement professionnel (Burn-out).</span>
                        </li>
                    </ul>
                </div>
            </div>

            <!-- PREVENTION -->
            <div class="bg-indigo-50 border border-indigo-200 rounded-xl p-6">
                <h3 class="font-bold text-indigo-900 mb-2 flex items-center gap-2"><i class="ph ph-smiley text-xl"></i> Équilibre & Prévention</h3>
                <div class="grid md:grid-cols-3 gap-6 text-sm text-indigo-800">
                    <div>
                        <strong>Le Remplacement :</strong> Ne restez pas seul. Prenez un remplaçant régulier pour vos congés.
                    </div>
                    <div>
                        <strong>Gestion du Temps :</strong> Déléguez l'administratif (Télésecrétariat ou Assistant).
                    </div>
                    <div>
                        <strong>Entraide :</strong> Rejoignez une CPTS pour le travail en réseau local.
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- TAB 6: CALCULATEUR (ORIGINAL COMPLET) -->
    <div id="tab-calculateur" class="tab-content">
        <div class="max-w-7xl mx-auto">
            <div class="grid lg:grid-cols-12 gap-8">
                <!-- INPUTS (Left) -->
                <div class="lg:col-span-7 space-y-6">
                    <!-- 1. Criteres -->
                    <div class="calculator-card border-l-4 border-indigo-500">
                        <div class="grid grid-cols-2 gap-4">
                            <div class="col-span-2">
                                <label class="input-label">Département (Fiscalité & LODEOM)</label>
                                <select id="departement" class="input-field font-bold text-indigo-900" onchange="calculate()">
                                    <option value="metro">Métropole (Standard)</option>
                                    <option value="mq">Martinique (LODEOM + Réduc IR 30%)</option>
                                    <option value="gp">Guadeloupe (LODEOM + Réduc IR 30%)</option>
                                    <option value="re">La Réunion (LODEOM + Réduc IR 30%)</option>
                                    <option value="gf">Guyane (LODEOM + Réduc IR 40%)</option>
                                    <option value="yt">Mayotte (LODEOM + Réduc IR 40%)</option>
                                </select>
                            </div>
                            <div>
                                <label class="input-label">Structure</label>
                                <select id="mode_exercice" class="input-field" onchange="toggleFormFields(); calculate()">
                                    <option value="ei">EI / BNC (Individuel)</option>
                                    <option value="selarl">SELARL (Société TNS)</option>
                                    <option value="selas">SELAS (Société Salarié)</option>
                                </select>
                            </div>
                            <div>
                                <label class="input-label">Profil</label>
                                <select id="profil_medecin" class="input-field" onchange="calculate()">
                                    <option value="titulaire">Titulaire</option>
                                    <option value="collaborateur">Collaborateur</option>
                                </select>
                            </div>
                            <!-- Options Spécifiques EI -->
                            <div id="micro_box" class="col-span-2 bg-yellow-50 p-3 rounded border border-yellow-200 hidden">
                                <label class="inline-flex items-center cursor-pointer w-full justify-between">
                                    <div>
                                        <span class="font-bold text-yellow-800 text-sm">Régime Micro-BNC ?</span>
                                        <p class="text-[10px] text-yellow-700">Abattement forfaitaire 34% (Si CA < 77 700€)</p>
                                    </div>
                                    <input type="checkbox" id="is_micro" class="sr-only peer" onchange="calculate()">
                                    <div class="relative w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:bg-yellow-500 after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full peer-checked:after:border-white"></div>
                                </label>
                            </div>
                            <!-- Options Spécifiques ZFU -->
                            <div class="col-span-2 bg-green-50 p-3 rounded-lg border border-green-200 flex items-center justify-between">
                                <div>
                                    <span class="font-bold text-green-800 text-sm block">Installation en ZFU ?</span>
                                    <span class="text-xs text-green-600" id="zfu_desc">Exonération 100% selon règles</span>
                                </div>
                                <label class="inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="is_zfu" class="sr-only peer" onchange="calculate()">
                                    <div class="relative w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:after:translate-x-full peer-checked:after:border-white after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:bg-green-600"></div>
                                </label>
                            </div>
                            <!-- Redevance Collab -->
                            <div id="redevance_box" class="hidden col-span-2">
                                <label class="input-label text-purple-700 font-bold">% Redevance (Reversé au titulaire)</label>
                                <input type="number" id="taux_redevance" value="20" class="input-field bg-purple-50 border-purple-200" oninput="calculate()">
                            </div>
                        </div>
                    </div>
                    <!-- 2. Activité -->
                    <div class="calculator-card border-l-4 border-green-500">
                        <div class="flex justify-between items-center mb-4">
                            <h3 class="font-bold text-green-800 flex items-center gap-2"><i class="ph ph-chart-line-up"></i> Revenus</h3>
                            <select id="secteur_conv" class="text-xs border rounded p-1 bg-green-50 text-green-800 font-bold" onchange="calculate()">
                                <option value="1">Secteur 1 (Charges réduites)</option>
                                <option value="2">Secteur 2 (Charges + élevées)</option>
                            </select>
                        </div>
                        <div class="grid grid-cols-2 gap-6 mb-4">
                            <div>
                                <label class="input-label">Consultation (€) <span id="val_tarif" class="float-right text-blue-600">30</span></label>
                                <input type="range" id="act_tarif" min="25" max="90" step="0.5" value="30" oninput="updateRange('val_tarif', this.value); calculate()">
                            </div>
                            <div>
                                <label class="input-label">Actes / Jour <span id="val_actes" class="float-right text-blue-600">25</span></label>
                                <input type="range" id="act_nb" min="5" max="60" step="1" value="25" oninput="updateRange('val_actes', this.value); calculate()">
                            </div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 mb-4">
                            <div>
                                <label class="input-label">Jours / Sem</label>
                                <input type="number" id="act_jours" value="4.5" class="input-field" step="0.5" oninput="calculate()">
                            </div>
                            <div>
                                <label class="input-label">Semaines / An</label>
                                <input type="number" id="act_semaines" value="46" class="input-field" oninput="calculate()">
                            </div>
                        </div>
                        <div class="bg-slate-50 p-3 rounded border border-slate-200">
                            <label class="input-label mb-2">Revenus Annexes (Détail)</label>
                            <div class="grid grid-cols-2 gap-3 text-xs">
                                <div><span>Forfait MT</span><input type="number" id="rev_fmt" value="15000" class="input-field mt-1" oninput="calculate()"></div>
                                <div><span>ROSP (Adulte)</span><input type="number" id="rev_rosp_adulte" value="3500" class="input-field mt-1" oninput="calculate()"></div>
                                <div><span>ROSP (Enfant)</span><input type="number" id="rev_rosp_enfant" value="1500" class="input-field mt-1" oninput="calculate()"></div>
                                <div><span>Forfait Struct.</span><input type="number" id="rev_structure" value="4600" class="input-field mt-1" oninput="calculate()"></div>
                            </div>
                        </div>
                    </div>
                    <!-- 3. Charges DETAILLEES -->
                    <div class="calculator-card border-l-4 border-red-500">
                        <h3 class="font-bold text-red-800 mb-4 flex items-center gap-2"><i class="ph ph-receipt"></i> Charges & Personnel</h3>
                        <div class="grid grid-cols-3 gap-3 text-xs">
                            <div><label>Loyer + Charges</label><input type="number" id="ch_loyer" value="900" class="input-field" oninput="calculate()"></div>
                            <div><label>Fluides</label><input type="number" id="ch_fluides" value="150" class="input-field" oninput="calculate()"></div>
                            <div><label>Telecom/Web</label><input type="number" id="ch_telecom" value="80" class="input-field" oninput="calculate()"></div>
                            <div><label>Doctolib</label><input type="number" id="ch_rdv" value="130" class="input-field" oninput="calculate()"></div>
                            <div><label>Logiciel Métier</label><input type="number" id="ch_logiciel" value="100" class="input-field" oninput="calculate()"></div>
                            <div><label>Ménage</label><input type="number" id="ch_menage" value="200" class="input-field" oninput="calculate()"></div>
                            <div><label>URPS/Ordre</label><input type="number" id="ch_divers" value="200" class="input-field" oninput="calculate()"></div>
                            <div><label>RCP/Assur.</label><input type="number" id="ch_assurances" value="350" class="input-field" oninput="calculate()"></div>
                            <div><label>Comptable</label><input type="number" id="ch_compta" value="250" class="input-field" oninput="calculate()"></div>
                            <div><label>Véhicule</label><input type="number" id="ch_vehicule" value="450" class="input-field" oninput="calculate()"></div>
                            <div><label>Banque</label><input type="number" id="ch_banque" value="40" class="input-field" oninput="calculate()"></div>
                            <div><label>Fournitures</label><input type="number" id="ch_fournitures" value="150" class="input-field" oninput="calculate()"></div>
                            <div><label>CFE/Taxes</label><input type="number" id="ch_cfe" value="50" class="input-field" oninput="calculate()"></div>
                        </div>
                        <!-- MODULE ASSISTANT -->
                        <div class="mt-4 bg-purple-50 p-4 rounded-xl border border-purple-100">
                            <div class="flex items-center justify-between mb-3">
                                <h4 class="font-bold text-purple-900 flex items-center gap-2"><span>👩‍⚕️</span> Assistant Médical</h4>
                                <label class="inline-flex items-center cursor-pointer">
                                    <input type="checkbox" id="has_assistant" class="sr-only peer" onchange="toggleAssistant()">
                                    <div class="relative w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:bg-purple-600 after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full peer-checked:after:border-white"></div>
                                </label>
                            </div>
                            <div id="assistant_block" class="hidden grid grid-cols-2 gap-4">
                                <div>
                                    <label class="input-label">Salaire Brut (€)</label>
                                    <input type="number" id="salaire_brut" value="2000" class="input-field" oninput="calculate()">
                                </div>
                                <div>
                                    <label class="input-label">Aide CPAM (An 1: 38k€)</label>
                                    <select id="annee_aide" class="input-field" onchange="calculate()">
                                        <option value="38000">Année 1 (38k€)</option>
                                        <option value="28000">Année 2 (28k€)</option>
                                        <option value="22000">Année 3+ (22k€)</option>
                                    </select>
                                </div>
                                <div class="col-span-2 text-xs text-purple-700 bg-purple-100 p-2 rounded flex justify-between">
                                    <span>Coût Chargé: <strong id="lbl_cout_assistant">0 €</strong></span>
                                    <span>Impact Net: <strong id="lbl_impact_assistant">+ 0 €</strong></span>
                                </div>
                            </div>
                        </div>
                    </div>
                    <!-- 4. Investissement -->
                    <div class="calculator-card border-l-4 border-slate-500">
                        <h3 class="font-bold text-slate-800 mb-4 flex items-center gap-2"><i class="ph ph-wrench"></i> Investissement Initial</h3>
                        <div class="grid grid-cols-3 gap-3 text-xs">
                            <div><label>Travaux</label><input type="number" id="inv_travaux" value="10000" class="input-field p-1" oninput="calculate()"></div>
                            <div><label>Matériel Méd.</label><input type="number" id="inv_materiel" value="15000" class="input-field p-1" oninput="calculate()"></div>
                            <div><label>Informatique</label><input type="number" id="inv_info" value="4000" class="input-field p-1" oninput="calculate()"></div>
                            <div><label>Mobilier</label><input type="number" id="inv_mobilier" value="4000" class="input-field p-1" oninput="calculate()"></div>
                            <div><label>Frais Juridiques</label><input type="number" id="inv_frais" value="2500" class="input-field p-1" oninput="calculate()"></div>
                            <div><label>Trésorerie BFR</label><input type="number" id="inv_bfr" value="5000" class="input-field p-1" oninput="calculate()"></div>
                        </div>
                    </div>
                </div>
                <!-- RESULTS (Right) -->
                <div class="lg:col-span-5 space-y-6">
                    <!-- Strategy Card -->
                    <div id="strategy_card" class="hidden bg-slate-800 text-white rounded-2xl p-5 shadow-xl ring-1 ring-white/10">
                        <h3 class="font-bold text-sm uppercase tracking-wider mb-4 flex items-center justify-between">
                            <span><i class="ph ph-sliders-horizontal"></i> Arbitrage Rémunération</span>
                            <span class="text-xs bg-slate-700 px-2 py-1 rounded">IS 15%/25%</span>
                        </h3>
                        <div class="mb-4">
                            <div class="flex justify-between text-xs mb-2 text-slate-400">
                                <span>Capitalisation</span><span>Revenu Immédiat</span>
                            </div>
                            <input type="range" id="taux_distribution" min="0" max="100" step="5" value="100"
                                   class="w-full h-2 bg-slate-600 rounded-lg appearance-none cursor-pointer"
                                   oninput="updateRange('val_distrib', this.value); calculate()">
                            <div class="text-right text-sm font-bold mt-1 text-blue-300"><span id="val_distrib">100</span>% versé</div>
                        </div>
                        <div class="grid grid-cols-2 gap-4 pt-4 border-t border-slate-700">
                            <div><p class="text-xs text-slate-400 mb-1">Reste Société (Net IS)</p><p class="text-lg font-bold text-emerald-400" id="res_treso_soc">0 €</p></div>
                            <div class="text-right"><p class="text-xs text-slate-400 mb-1">Net Poche (Après IR)</p><p class="text-xl font-bold text-white" id="res_net_poche_strategy">0 €</p></div>
                        </div>
                    </div>
                    <!-- Main Result -->
                    <div class="result-main-card">
                        <h3 class="text-sm font-medium opacity-80 uppercase tracking-widest mb-2">Net Disponible (Poche)</h3>
                        <div class="result-value mb-1" id="res_net_apres_impot">0 €</div>
                        <p class="text-sm opacity-70 mb-6">/ an (après impôt)</p>
                        <div class="grid grid-cols-2 gap-4 border-t border-white/10 pt-4">
                            <div><div class="text-2xl font-bold" id="res_net_mois">0 €</div><div class="text-xs opacity-70 uppercase">Mensuel</div></div>
                            <div class="border-l border-white/10 pl-4"><div class="text-2xl font-bold" id="res_ca_total">0 €</div><div class="text-xs opacity-70 uppercase">Chiffre d'Affaires</div></div>
                        </div>
                    </div>
                    <!-- Chart & Details -->
                    <div class="calculator-card">
                        <h4 class="font-bold text-slate-700 mb-4 text-center text-sm uppercase">Répartition</h4>
                        <div class="relative h-56 w-full flex justify-center mb-6"><canvas id="financialChart"></canvas></div>
                        <div class="space-y-2 text-sm">
                            <div class="flex justify-between p-2 rounded bg-red-50 text-red-900"><span>Charges Fixes</span><span class="font-bold" id="disp_charges_fixes">0 €</span></div>
                            <div class="flex justify-between p-2 rounded bg-purple-50 text-purple-900 hidden" id="row_redevance"><span>Redevance</span><span class="font-bold" id="disp_redevance">0 €</span></div>
                            <div class="flex justify-between p-2 rounded bg-orange-50 text-orange-900"><span id="lbl_social">Charges Sociales</span><span class="font-bold" id="disp_social">0 €</span></div>
                            <div class="flex justify-between p-2 rounded bg-blue-50 text-blue-900"><span id="lbl_impot">Impôt Revenu</span><span class="font-bold" id="disp_impot">0 €</span></div>
                            <div class="flex justify-between p-2 rounded bg-indigo-50 text-indigo-900 hidden" id="row_is"><span>Impôt Sociétés</span><span class="font-bold" id="disp_is">0 €</span></div>
                            <div class="flex justify-between p-2 rounded bg-emerald-50 text-emerald-900 hidden" id="row_treso"><span>Trésorerie Société</span><span class="font-bold" id="disp_treso_soc">0 €</span></div>
                        </div>
                    </div>

                     <!-- IA EXPLANATION BLOCK -->
                    <div class="bg-indigo-50 border border-indigo-200 rounded-xl p-4 mt-4">
                        <h3 class="font-bold text-indigo-900 mb-2 flex items-center gap-2">
                            🧠 Analyse explicative
                        </h3>

                        <div id="ai_explanation" class="text-sm text-indigo-800 space-y-1">
                            <!-- Contenu injecté dynamiquement par l’IA explicative -->
                        </div>

                        <p class="text-xs text-indigo-600 mt-2 italic">
                            Analyse automatique à visée pédagogique – non constitutive d’un conseil fiscal, social ou juridique personnalisé.
                        </p>
                    </div>

                    <div class="bg-blue-50 p-6 rounded-xl border border-blue-200 mt-6">
                        <h3 class="font-bold text-blue-800 mb-2 flex justify-between items-center text-sm"><span>💡 Budget Initial</span><span class="text-xl" id="res_invest">0 €</span></h3>
                    </div>
                </div>
            </div>
        </div>
    </div>
    <!-- TAB 7: OPTIMISATION (ORIGINAL COMPLET) -->
    <div id="tab-optimisation" class="tab-content">
        <div class="max-w-7xl mx-auto" id="opt-simulator-content">
            <div class="flex justify-between items-center mb-6">
                <div>
                    <h2 class="text-3xl font-extrabold text-slate-800">Optimisation Fiscale <span class="text-medical-blue">Martinique 2025</span></h2>
                    <p class="text-slate-500 text-sm mt-1">Comparatif BNC vs Montage Optimisé (SELAS + SPFPL + SCI IS)</p>
                </div>
                <div class="flex gap-3">
                    <button onclick="resetOptSim()" class="text-sm text-slate-500 hover:text-slate-700 underline">Paramètres par défaut</button>
                    <!-- Ce bouton EXPORTE LE RAPPORT COMPLET -->
                    <button onclick="exportFullReport()" class="bg-medical-blue text-white px-4 py-2 rounded-lg font-bold text-sm shadow hover:bg-blue-700 flex items-center gap-2">
                        <i class="ph ph-file-pdf"></i> Export Rapport Complet
                    </button>
                </div>
            </div>
            <div class="grid lg:grid-cols-12 gap-8">
                
                <!-- INPUTS -->
                <div class="lg:col-span-4 space-y-6">
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2"><i class="ph ph-sliders"></i> Données Financières</h3>
                        
                        <div class="calc-input-group">
                            <div class="calc-label"><span>Chiffre d'Affaires Annuel</span><span class="calc-val" id="opt_val_ca">350 k€</span></div>
                            <input type="range" id="opt_in_ca" min="200" max="1000" step="10" value="350" oninput="updateOptSim()">
                        </div>
                        <div class="calc-input-group">
                            <div class="calc-label"><span>Charges Exploitation (% CA)</span><span class="calc-val" id="opt_val_charges">40 %</span></div>
                            <input type="range" id="opt_in_charges" min="30" max="60" step="1" value="40" oninput="updateOptSim()">
                        </div>
                        <div class="calc-input-group">
                            <div class="calc-label"><span>Rémunération Médecin</span><span class="calc-val" id="opt_val_remun">120 k€</span></div>
                            <input type="range" id="opt_in_remun" min="50" max="300" step="5" value="120" oninput="updateOptSim()">
                        </div>
                    </div>
                    <div class="bg-white p-6 rounded-xl shadow-sm border border-slate-200">
                        <h3 class="font-bold text-slate-700 mb-4 flex items-center gap-2"><i class="ph ph-buildings"></i> Montage Patrimonial</h3>
                        
                        <div class="calc-input-group">
                            <div class="calc-label"><span>Loyer SCI (Optionnel)</span><span class="calc-val" id="opt_val_loyer">20 k€</span></div>
                            <input type="range" id="opt_in_loyer" min="0" max="80" step="1" value="20" oninput="updateOptSim()">
                        </div>
                        <div class="calc-input-group">
                            <div class="calc-label"><span>Abondements PEE/PERCO</span><span class="calc-val" id="opt_val_abond">0 k€</span></div>
                            <input type="range" id="opt_in_abond" min="0" max="20" step="1" value="0" oninput="updateOptSim()">
                        </div>
                        <div class="flex items-center justify-between p-3 bg-green-50 rounded-lg border border-green-100">
                            <div>
                                <span class="font-bold text-green-800 text-sm">Zone Franche (ZFU) ?</span>
                                <div class="text-[10px] text-green-600">Exonération d'impôt sur les bénéfices</div>
                            </div>
                            <label class="inline-flex items-center cursor-pointer">
                                <input type="checkbox" id="opt_in_zfu" class="sr-only peer" onchange="updateOptSim()">
                                <div class="relative w-11 h-6 bg-slate-200 peer-focus:outline-none rounded-full peer peer-checked:bg-green-600 after:content-[''] after:absolute after:top-[2px] after:start-[2px] after:bg-white after:border-gray-300 after:border after:rounded-full after:h-5 after:w-5 after:transition-all peer-checked:after:translate-x-full peer-checked:after:border-white"></div>
                            </label>
                        </div>
                    </div>
                    
                    <div class="calc-input-group">
                         <div class="calc-label text-slate-500"><span>Taux Croissance CA (Projection)</span><span class="calc-val text-sm" id="opt_val_croissance">3 %</span></div>
                         <input type="range" id="opt_in_croissance" min="2" max="5" step="0.5" value="3" oninput="updateOptSim()">
                    </div>
                </div>
                <!-- RESULTS -->
                <div class="lg:col-span-8 space-y-6">
                    
                    <!-- KPI CARDS -->
                    <div class="grid grid-cols-1 md:grid-cols-3 gap-4">
                        <div class="kpi-box border-l-4 border-l-green-500">
                            <div class="kpi-title">Économie Fiscale Annuelle</div>
                            <div class="kpi-value text-green-600" id="opt_kpi_eco_annuelle">+ 0 €</div>
                            <div class="kpi-sub text-green-800">Gain immédiat</div>
                        </div>
                        <div class="kpi-box">
                            <div class="kpi-title">Gains Cumulés 10 ans</div>
                            <div class="kpi-value text-blue-600" id="opt_kpi_gain_10ans">0 €</div>
                            <div class="kpi-sub text-slate-500">Capitalisation</div>
                        </div>
                        <div class="kpi-box">
                            <div class="kpi-title">Taux Retour Net Optimisé</div>
                            <div class="kpi-value text-indigo-600" id="opt_kpi_taux_retour">0 %</div>
                            <div class="kpi-sub text-slate-500">Efficacité Globale</div>
                        </div>
                    </div>
                    <!-- COMPARATIVE TABLE -->
                    <div class="bg-white rounded-xl shadow-sm border border-slate-200 overflow-hidden">
                        <table class="comp-table">
                            <thead>
                                <tr>
                                    <th>Métrique</th>
                                    <th>Optimisé € (SELAS+SPFPL)</th>
                                    <th>Classique € (BNC)</th>
                                    <th>Économie €</th>
                                    <th>Gain %</th>
                                </tr>
                            </thead>
                            <tbody>
                                <tr>
                                    <td>Charges Fiscales</td>
                                    <td id="opt_td_opt_fiscal" class="font-medium text-slate-700">0 €</td>
                                    <td id="opt_td_cla_fiscal" class="text-slate-500">0 €</td>
                                    <td id="opt_td_diff_fiscal" class="positive-gain">0 €</td>
                                    <td id="opt_td_pct_fiscal" class="text-xs text-green-600 font-bold">0%</td>
                                </tr>
                                <tr>
                                    <td>Charges Sociales</td>
                                    <td id="opt_td_opt_social" class="font-medium text-slate-700">0 €</td>
                                    <td id="opt_td_cla_social" class="text-slate-500">0 €</td>
                                    <td id="opt_td_diff_social" class="positive-gain">0 €</td>
                                    <td id="opt_td_pct_social" class="text-xs text-green-600 font-bold">0%</td>
                                </tr>
                                <tr class="bg-blue-50 border-t-2 border-blue-100">
                                    <td><strong>NET RETENU</strong></td>
                                    <td id="opt_td_opt_net" class="font-black text-xl text-blue-700">0 €</td>
                                    <td id="opt_td_cla_net" class="font-bold text-lg text-slate-600">0 €</td>
                                    <td id="opt_td_diff_net" class="font-bold text-lg text-green-600">+ 0 €</td>
                                    <td id="opt_td_pct_net" class="font-bold text-green-700">+ 0%</td>
                                </tr>
                            </tbody>
                        </table>
                    </div>
                    <!-- CHARTS -->
                    <div class="grid md:grid-cols-2 gap-6">
                        <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                            <h4 class="font-bold text-slate-700 mb-4 text-xs uppercase text-center">Projection Net Retenu 2025-2035</h4>
                            <div class="h-64"><canvas id="optChartProj"></canvas></div>
                        </div>
                        <div class="bg-white p-4 rounded-xl border border-slate-200 shadow-sm">
                            <h4 class="font-bold text-slate-700 mb-4 text-xs uppercase text-center">Répartition Charges Annuelles</h4>
                            <div class="h-64"><canvas id="optChartDist"></canvas></div>
                        </div>
                    </div>
                </div>
            </div>
            
            <div class="grid md:grid-cols-2 gap-12 items-center mt-12 mb-12">
                <!-- Texte & Partenaire -->
                <div class="flex flex-col justify-center">
                    <!-- Logos Partenaires -->
                    <div class="mb-8 flex flex-wrap gap-4">
                        <!-- No Partner Logo here as requested -->
                    </div>
                    <h2 class="text-3xl font-bold text-slate-800 mb-4">Optimisation Fiscale et Sociale</h2>
                    <p class="text-slate-600 mb-6 leading-relaxed font-medium text-lg">
                        Nous vous proposons des solutions sur mesure afin de réduire vos charges sociales et fiscales, tout en respectant les réglementations en vigueur et les contraintes ordinales.
                    </p>
                    
                    <div class="space-y-4">
                        <div class="bg-white p-4 rounded-xl border-l-4 border-indigo-500 shadow-sm">
                            <h4 class="font-bold text-indigo-900 text-sm mb-1">1. Validation ZFU</h4>
                            <p class="text-xs text-slate-600">Vérification cadastrale impérative pour sécuriser 5 ans d'exonération d'IS.</p>
                        </div>
                        <div class="bg-white p-4 rounded-xl border-l-4 border-blue-500 shadow-sm">
                            <h4 class="font-bold text-blue-900 text-sm mb-1">2. Montage Holding (SPFPL)</h4>
                            <p class="text-xs text-slate-600">Structure pivot pour capitaliser la trésorerie avec une fiscalité réduite (1.25%).</p>
                        </div>
                        <div class="bg-white p-4 rounded-xl border-l-4 border-orange-500 shadow-sm">
                            <h4 class="font-bold text-orange-900 text-sm mb-1">3. Levier Immobilier (SCI)</h4>
                            <p class="text-xs text-slate-600">Dissocier l'immobilier de l'exploitation pour protéger le patrimoine.</p>
                        </div>
                    </div>
                </div>
                
                <!-- Diagramme Visuel Cible -->
                <div class="bg-slate-50 p-8 rounded-2xl border border-slate-200 relative flex flex-col items-center justify-center">
                    <h3 class="font-bold text-slate-500 text-sm uppercase tracking-widest mb-8">Le Schéma Cible (Martinique)</h3>
                    
                    <!-- NIVEAU 1: MEDECIN -->
                    <div class="schema-box box-pro w-64 mb-12">
                        <div class="font-bold">Médecin (Personne Physique)</div>
                        <div class="text-[10px] italic">Résident Fiscal Martinique</div>
                        <div class="absolute -right-24 top-0 bg-green-100 text-green-800 text-[10px] px-2 py-1 rounded box-dom">DOM: Abattement IR 30%</div>
                    </div>
                    <div class="h-10 w-0.5 bg-slate-300 -my-6 mb-6"></div>
                    <!-- NIVEAU 2: HOLDING -->
                    <div class="schema-box box-hold w-64 mb-12">
                        <div class="font-bold">SPFPL (Holding)</div>
                        <div class="text-[10px] italic">Trésorerie & Investissement</div>
                        <div class="text-[10px] mt-1 font-bold">Régime Mère-Fille</div>
                    </div>
                    <div class="h-10 w-0.5 bg-slate-300 -my-6 mb-6"></div>
                    <!-- NIVEAU 3: SPLIT -->
                    <div class="flex gap-8 w-full justify-center">
                        <!-- SELAS -->
                        <div class="flex flex-col items-center">
                            <div class="schema-box box-pro w-48 relative">
                                <div class="font-bold">SELAS Médicale</div>
                                <div class="text-[10px] italic">Génère le CASH</div>
                                <div class="absolute -left-4 -bottom-4 bg-green-100 text-green-800 text-[10px] px-2 py-1 rounded box-dom border-green-600 border border-dashed">ZFU (Exo 100%) ?</div>
                            </div>
                        </div>
                        
                        <!-- SCI -->
                        <div class="flex flex-col items-center">
                            <div class="schema-box box-immo w-48">
                                <div class="font-bold">SCI à l'IS</div>
                                <div class="text-[10px] italic">Immobilier / Capitalise</div>
                            </div>
                        </div>
                    </div>
                    
                    <!-- SVG Lines -->
                    <svg class="absolute inset-0 w-full h-full pointer-events-none" style="z-index: 0;">
                        <!-- Medecin to Holding -->
                        <line x1="50%" y1="60" x2="50%" y2="110" stroke="#94a3b8" stroke-width="2" />
                        <!-- Holding to Split -->
                        <line x1="50%" y1="180" x2="50%" y2="230" stroke="#94a3b8" stroke-width="2" />
                        <!-- Split Lines -->
                        <line x1="50%" y1="230" x2="25%" y2="230" stroke="#94a3b8" stroke-width="2" />
                        <line x1="25%" y1="230" x2="25%" y2="260" stroke="#94a3b8" stroke-width="2" />
                        <line x1="50%" y1="230" x2="75%" y2="230" stroke="#94a3b8" stroke-width="2" />
                        <line x1="75%" y1="230" x2="75%" y2="260" stroke="#94a3b8" stroke-width="2" />
                    </svg>
                </div>
            </div>
        </div>
    </div>
    <!-- TAB 8: CHECKLIST INTERACTIVE (NOUVELLE) -->
    <div id="tab-checklist" class="tab-content">
        <div class="max-w-6xl mx-auto">
            <div class="text-center mb-8">
                <h2 class="text-3xl font-bold text-slate-800 mb-3">Checklist Interactive d'Installation</h2>
                <p class="text-slate-600">Suivez votre progression étape par étape</p>
                
                <!-- Barre de progression globale -->
                <div class="max-w-md mx-auto mt-6">
                    <div class="flex justify-between text-sm text-slate-600 mb-2">
                        <span>Progression globale</span>
                        <span id="checklist-progress-text">0% (0/24)</span>
                    </div>
                    <div class="progress-bar">
                        <div class="progress-fill" id="checklist-progress-bar" style="width: 0%"></div>
                    </div>
                </div>
            </div>
            <!-- Sections de checklist -->
            <div class="space-y-8">
                
                <!-- Phase 1: Préparation -->
                <div class="calculator-card border-l-4 border-l-blue-500" id="checklist-phase-1">
                    <h3 class="font-bold text-blue-800 mb-4 flex items-center gap-2">
                        <i class="ph ph-compass text-xl"></i> Phase 1: Préparation Stratégique
                        <span class="ml-auto text-sm bg-blue-100 text-blue-800 px-2 py-1 rounded" id="phase1-count">0/6</span>
                    </h3>
                    
                    <div class="space-y-3">
                        <div class="checklist-item" data-id="1" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">1</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Définir le projet médical</h4>
                                <p class="text-sm text-slate-600">Spécialité, zone d'exercice, objectifs de revenus</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="2" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">2</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Choisir le statut juridique</h4>
                                <p class="text-sm text-slate-600">EI, SELARL, SELAS selon vos objectifs</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="3" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">3</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Étudier les aides territoriales</h4>
                                <p class="text-sm text-slate-600">ZIP, ZFU, LODEOM selon votre localisation</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="4" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">4</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Rechercher le local</h4>
                                <p class="text-sm text-slate-600">Emplacement, surface, normes ERP</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="5" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">5</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Établir le business plan</h4>
                                <p class="text-sm text-slate-600">Prévisionnel financier, seuil de rentabilité</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="6" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">6</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Sécuriser le financement</h4>
                                <p class="text-sm text-slate-600">Apport personnel, prêt bancaire, aides</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                    </div>
                </div>
                <!-- Phase 2: Démarches administratives -->
                <div class="calculator-card border-l-4 border-l-emerald-500" id="checklist-phase-2">
                    <h3 class="font-bold text-emerald-800 mb-4 flex items-center gap-2">
                        <i class="ph ph-files text-xl"></i> Phase 2: Démarches Administratives
                        <span class="ml-auto text-sm bg-emerald-100 text-emerald-800 px-2 py-1 rounded" id="phase2-count">0/8</span>
                    </h3>
                    
                    <div class="space-y-3">
                        <div class="checklist-item" data-id="7" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">7</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Inscription au Conseil de l'Ordre</h4>
                                <p class="text-sm text-slate-600">Dossier complet 3 mois avant ouverture</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="8" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">8</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Enregistrement CPAM</h4>
                                <p class="text-sm text-slate-600">Avec attestation ordinale</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="9" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">9</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Immatriculation URSSAF/INPI</h4>
                                <p class="text-sm text-slate-600">Dans les 8 jours du début d'activité</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="10" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">10</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Affiliation CARMF</h4>
                                <p class="text-sm text-slate-600">Retraite obligatoire dans le mois</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="11" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">11</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Assurance RCP</h4>
                                <p class="text-sm text-slate-600">Obligatoire avant le premier patient</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="12" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">12</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Ouverture compte bancaire pro</h4>
                                <p class="text-sm text-slate-600">Séparation obligatoire des flux</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="13" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">13</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Choix du comptable</h4>
                                <p class="text-sm text-slate-600">Spécialisé professions médicales</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="14" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">14</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Prévoyance complémentaire</h4>
                                <p class="text-sm text-slate-600">Couverture arrêt maladie J1-J90</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                    </div>
                </div>
                <!-- Phase 3: Installation pratique -->
                <div class="calculator-card border-l-4 border-l-orange-500" id="checklist-phase-3">
                    <h3 class="font-bold text-orange-800 mb-4 flex items-center gap-2">
                        <i class="ph ph-wrench text-xl"></i> Phase 3: Installation Pratique
                        <span class="ml-auto text-sm bg-orange-100 text-orange-800 px-2 py-1 rounded" id="phase3-count">0/6</span>
                    </h3>
                    
                    <div class="space-y-3">
                        <div class="checklist-item" data-id="15" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">15</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Aménagement du cabinet</h4>
                                <p class="text-sm text-slate-600">Travaux, mobilier, conformité PMR</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="16" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">16</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Équipement médical</h4>
                                <p class="text-sm text-slate-600">Matériel diagnostic, consommables</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="17" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">17</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Système informatique</h4>
                                <p class="text-sm text-slate-600">Logiciel métier, lecteur CV, imprimante</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="18" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">18</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Télécommunications</h4>
                                <p class="text-sm text-slate-600">Internet, téléphone, messagerie sécurisée</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="19" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">19</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Sécurité & conformité</h4>
                                <p class="text-sm text-slate-600">Extincteur, RGPD, gestion DASRI</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="20" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">20</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Affichages obligatoires</h4>
                                <p class="text-sm text-slate-600">Tarifs, RGPD, accessibilité, urgences</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                    </div>
                </div>
                <!-- Phase 4: Lancement -->
                <div class="calculator-card border-l-4 border-l-purple-500" id="checklist-phase-4">
                    <h3 class="font-bold text-purple-800 mb-4 flex items-center gap-2">
                        <i class="ph ph-rocket-launch text-xl"></i> Phase 4: Lancement d'Activité
                        <span class="ml-auto text-sm bg-purple-100 text-purple-800 px-2 py-1 rounded" id="phase4-count">0/4</span>
                    </h3>
                    
                    <div class="space-y-3">
                        <div class="checklist-item" data-id="21" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">21</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Communication & visibilité</h4>
                                <p class="text-sm text-slate-600">Site web, Doctolib, annuaires</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="22" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">22</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Réseau professionnel</h4>
                                <p class="text-sm text-slate-600">Confrères, pharmacies, laboratoires</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="23" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">23</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Premier patient</h4>
                                <p class="text-sm text-slate-600">Test complet du circuit de soins</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                        <div class="checklist-item" data-id="24" onclick="toggleChecklistItem(this)">
                            <div class="checklist-icon">24</div>
                            <div class="flex-1">
                                <h4 class="font-semibold text-slate-800">Suivi & optimisation</h4>
                                <p class="text-sm text-slate-600">Tableaux de bord, ajustements</p>
                            </div>
                            <i class="ph ph-check text-xl text-slate-400 transition-colors"></i>
                        </div>
                    </div>
                </div>
            </div>
            <!-- Actions de la checklist -->
            <div class="mt-8 flex justify-center gap-4 flex-wrap">
                <button onclick="resetChecklist()" class="px-6 py-3 bg-slate-600 text-white rounded-lg font-semibold hover:bg-slate-700 transition flex items-center">
                    <i class="ph ph-arrow-clockwise mr-2"></i>Réinitialiser
                </button>
                <button onclick="exportChecklistPDF()" class="px-6 py-3 bg-medical-blue text-white rounded-lg font-semibold hover:bg-blue-700 transition flex items-center">
                    <i class="ph ph-file-pdf mr-2"></i>Exporter PDF
                </button>
            </div>
        </div>
    </div>
  </main>
  <footer class="bg-slate-900 text-slate-300 py-12 mt-12" id="contact-formulaire">
      <div class="max-w-7xl mx-auto px-6">
          <div class="flex flex-col md:flex-row justify-between items-center mb-8">
              <div class="mb-6 md:mb-0 text-center md:text-left">
                  <img src="https://elodiatech.com/wp-content/uploads/2023/11/elodia-tech-LOGO-B-1536x1152.png" alt="Elodia Tech" class="h-14 w-auto mb-2 mx-auto md:mx-0 brightness-0 invert opacity-90">
                  <p class="text-sm text-slate-400 font-medium tracking-wide">Ingénierie médicale</p>
              </div>
              <div class="text-center">
                  <p class="text-white font-bold mb-3">Besoin d'un audit personnalisé ?</p>
                  <a href="https://elodiatech.com/formulaire-rendez-vous/" target="_blank" class="bg-medical-blue text-white px-6 py-3 rounded-lg font-bold shadow-lg hover:bg-blue-700 transition flex items-center gap-2">
                      <i class="ph ph-file-text text-xl"></i> Remplir le Formulaire
                  </a>
              </div>
          </div>
          <div class="border-t border-slate-800 pt-8 flex flex-col md:flex-row justify-between text-xs text-slate-600">
              <p>&copy; 2025 Elodia Tech. Données fiscales indicatives Martinique 2025.</p>
              <div class="flex gap-4 mt-4 md:mt-0">
                  <a href="#" class="hover:text-white">Mentions Légales</a>
                  <a href="#" class="hover:text-white">CGU</a>
                  <a href="#" class="hover:text-white">Contact</a>
              </div>
          </div>
      </div>
  </footer>
  <script>
    // --- MATH HELPERS (Common) ---
    function calculateIR(revenuImposable) {
        if (revenuImposable <= 0) return 0;
        let impot = 0;
        const t1 = 11294, t2 = 28797, t3 = 82341, t4 = 177106;
        let base = revenuImposable;
        if (base > t4) { impot += (base - t4) * 0.45; base = t4; }
        if (base > t3) { impot += (base - t3) * 0.41; base = t3; }
        if (base > t2) { impot += (base - t2) * 0.30; base = t2; }
        if (base > t1) { impot += (base - t1) * 0.11; }
        return impot;
    }

    function calculateIS(benefice) {
        if (benefice <= 0) return 0;
        if (benefice <= 42500) return benefice * 0.15;
        return (42500 * 0.15) + ((benefice - 42500) * 0.25);
    }

    // --- SECTION 6 CALCULATOR ---
    let financeChart = null;

    function calculate() {
        const deptEl = document.getElementById('departement');
        const modeEl = document.getElementById('mode_exercice');
        const profilEl = document.getElementById('profil_medecin');
        if (!deptEl || !modeEl || !profilEl) return;

        const dept = deptEl.value;
        const statut = modeEl.value;
        const profil = profilEl.value;
        const isZfu = document.getElementById('is_zfu').checked;
        const isMicro = document.getElementById('is_micro').checked && statut === 'ei';
        const secteur = document.getElementById('secteur_conv').value;
        const tauxDistrib = parseInt(document.getElementById('taux_distribution').value) / 100;

        const isGuyaneMayotte = ['gf', 'yt'].includes(dept);
        const isDROM = ['mq', 'gp', 're'].includes(dept) || isGuyaneMayotte;

        // Honoraires
        const tarif = parseFloat(document.getElementById('act_tarif').value);
        const actes = parseFloat(document.getElementById('act_nb').value);
        const jours = parseFloat(document.getElementById('act_jours').value);
        const semaines = parseFloat(document.getElementById('act_semaines').value);
        const caActes = tarif * actes * jours * semaines;
        const annexes = parseFloat(document.getElementById('rev_fmt').value) +
            parseFloat(document.getElementById('rev_rosp_adulte').value) +
            parseFloat(document.getElementById('rev_rosp_enfant').value) +
            parseFloat(document.getElementById('rev_structure').value);

        let redevance = 0;
        if (profil === 'collaborateur') {
            const redevanceBox = document.getElementById('redevance_box');
            if (redevanceBox) redevanceBox.classList.remove('hidden');
            redevance = caActes * (parseFloat(document.getElementById('taux_redevance').value) / 100);
            const rowRedevance = document.getElementById('row_redevance');
            if (rowRedevance) rowRedevance.classList.remove('hidden');
        } else {
            const redevanceBox = document.getElementById('redevance_box');
            if (redevanceBox) redevanceBox.classList.add('hidden');
            const rowRedevance = document.getElementById('row_redevance');
            if (rowRedevance) rowRedevance.classList.add('hidden');
        }

        const caTotal = caActes + annexes;

        // Charges Fixes
        let chargesFixesMois = 0;
        ['loyer', 'fluides', 'telecom', 'rdv', 'logiciel', 'menage', 'divers', 'assurances', 'compta', 'vehicule', 'banque', 'fournitures', 'cfe'].forEach(id => {
            const el = document.getElementById('ch_' + id);
            chargesFixesMois += (el ? parseFloat(el.value) : 0) || 0;
        });
        let chargesFixesAnnuelles = chargesFixesMois * 12;

        const hasAssistant = document.getElementById('has_assistant').checked;
        let coutAssistantAn = 0;
        let impactAssistant = 0;
        if (hasAssistant) {
            const salaireBrut = parseFloat(document.getElementById('salaire_brut').value) || 0;
            coutAssistantAn = (salaireBrut * 1.42) * 12; 
            const aideAssistant = parseFloat(document.getElementById('annee_aide').value) || 0;
            impactAssistant = aideAssistant - coutAssistantAn;
            const lblCout = document.getElementById('lbl_cout_assistant');
            if (lblCout) lblCout.innerText = Math.round(coutAssistantAn).toLocaleString() + ' €';
            const lblImpact = document.getElementById('lbl_impact_assistant');
            if (lblImpact) {
                lblImpact.innerText = (impactAssistant > 0 ? "+ " : "") + Math.round(impactAssistant).toLocaleString() + ' €';
                lblImpact.className = impactAssistant > 0 ? "text-green-600 font-bold" : "text-red-600 font-bold";
            }
        }

        const superBrutDispo = caTotal - chargesFixesAnnuelles - redevance + (hasAssistant ? impactAssistant : 0);

        let tauxSocialTNS = secteur === '1' ? 0.44 : 0.54;
        let tauxSocialSal = 0.75; 

        if (isDROM) {
            tauxSocialTNS = secteur === '1' ? 0.32 : 0.42;
            tauxSocialSal = 0.58;
        }

        let impotIR = 0, impotIS = 0, chargesSociales = 0;
        let netPoche = 0, tresoSociete = 0, labelSocial = "";

        if (isMicro && statut === 'ei') {
            const baseAbattue = caTotal * 0.66;
            chargesSociales = caTotal * 0.222;
            labelSocial = "Micro-Social (22.2% CA)";
            let baseIR = baseAbattue;
            if (isZfu) {
                baseIR = Math.max(0, baseAbattue - 50000);
                const zfuDesc = document.getElementById('zfu_desc');
                if (zfuDesc) zfuDesc.innerText = "Exo. sur 50k€ de base";
            }
            impotIR = calculateIR(baseIR);
            netPoche = caTotal - chargesSociales - chargesFixesAnnuelles - impotIR;
        } else if (statut === 'selas') {
            const enveloppeRemun = superBrutDispo * tauxDistrib;
            const resteSoc = superBrutDispo - enveloppeRemun;
            const remunNet = enveloppeRemun / (1 + tauxSocialSal);
            chargesSociales = enveloppeRemun - remunNet;
            labelSocial = isDROM ? "Cotis. Salarié (LODEOM)" : "Cotis. Salarié";
            let baseIS = resteSoc;
            if (isZfu) {
                baseIS = Math.max(0, resteSoc - 50000);
                const zfuDesc = document.getElementById('zfu_desc');
                if (zfuDesc) zfuDesc.innerText = "Abatt. 50k€ sur base IS";
            }
            impotIS = calculateIS(baseIS);
            tresoSociete = resteSoc - impotIS;
            impotIR = calculateIR(remunNet * 0.9);
            netPoche = remunNet - impotIR;
        } else if (statut === 'selarl') {
            const enveloppeRemun = superBrutDispo * tauxDistrib;
            const resteSoc = superBrutDispo - enveloppeRemun;
            const remunNet = enveloppeRemun / (1 + tauxSocialTNS);
            chargesSociales = enveloppeRemun - remunNet;
            labelSocial = isDROM ? "Cotis. TNS (LODEOM)" : "Cotis. TNS";
            let baseIS = resteSoc;
            if (isZfu) {
                baseIS = Math.max(0, resteSoc - 50000);
                const zfuDesc = document.getElementById('zfu_desc');
                if (zfuDesc) zfuDesc.innerText = "Abatt. 50k€ sur base IS";
            }
            impotIS = calculateIS(baseIS);
            tresoSociete = resteSoc - impotIS;
            impotIR = calculateIR(remunNet * 0.9);
            netPoche = remunNet - impotIR;
        } else {
            const bncNetSocial = superBrutDispo / (1 + tauxSocialTNS);
            chargesSociales = superBrutDispo - bncNetSocial;
            labelSocial = isDROM ? "Cotis. TNS (LODEOM)" : "Cotis. TNS";
            let baseIR = bncNetSocial;
            if (isZfu) {
                baseIR = Math.max(0, bncNetSocial - 50000);
                const zfuDesc = document.getElementById('zfu_desc');
                if (zfuDesc) zfuDesc.innerText = "Exo. sur 50k€ de BNC";
            }
            impotIR = calculateIR(baseIR);
            netPoche = bncNetSocial - impotIR;
        }

        if (isDROM && impotIR > 0) {
            let reduction = 0, plafond = 0;
            if (isGuyaneMayotte) { reduction = impotIR * 0.40; plafond = 4050; }
            else { reduction = impotIR * 0.30; plafond = 2450; }
            if (reduction > plafond) reduction = plafond;
            impotIR -= reduction;
            if (impotIR < 0) impotIR = 0;
            netPoche += reduction;
            const lblImpot = document.getElementById('lbl_impot');
            if (lblImpot) lblImpot.innerText = isGuyaneMayotte ? "IR (Réduc 40% incluse)" : "IR (Réduc 30% incluse)";
        } else {
            const lblImpot = document.getElementById('lbl_impot');
            if (lblImpot) lblImpot.innerText = "Impôt Revenu";
        }

        const fmt = (n) => Math.round(n).toLocaleString('fr-FR') + ' €';
        document.getElementById('res_net_apres_impot').innerText = fmt(netPoche);
        document.getElementById('res_net_mois').innerText = fmt(netPoche / 12);
        document.getElementById('res_ca_total').innerText = fmt(caTotal);
        document.getElementById('res_net_poche_strategy').innerText = fmt(netPoche);
        document.getElementById('res_treso_soc').innerText = fmt(tresoSociete);
        document.getElementById('disp_charges_fixes').innerText = fmt(chargesFixesAnnuelles + coutAssistantAn);
        document.getElementById('disp_redevance').innerText = fmt(redevance);
        document.getElementById('disp_social').innerText = fmt(chargesSociales);
        document.getElementById('disp_impot').innerText = fmt(impotIR);
        document.getElementById('lbl_social').innerText = labelSocial;

        const rowIS = document.getElementById('row_is');
        const rowTreso = document.getElementById('row_treso');
        if (statut === 'selarl' || statut === 'selas') {
            if (rowIS) rowIS.classList.remove('hidden');
            if (rowTreso) rowTreso.classList.remove('hidden');
            document.getElementById('disp_is').innerText = fmt(impotIS);
            document.getElementById('disp_treso_soc').innerText = fmt(tresoSociete);
        } else {
            if (rowIS) rowIS.classList.add('hidden');
            if (rowTreso) rowTreso.classList.add('hidden');
        }

        let investTotal = 0;
        ['inv_travaux', 'inv_materiel', 'inv_info', 'inv_mobilier', 'inv_frais', 'inv_bfr'].forEach(id => {
            const el = document.getElementById(id);
            investTotal += (el ? parseFloat(el.value) : 0) || 0;
        });
        document.getElementById('res_invest').innerText = fmt(investTotal);

        updateChart(netPoche, impotIR, chargesSociales, chargesFixesAnnuelles + coutAssistantAn, redevance, tresoSociete, impotIS);

        // --- IA CONTEXT TRIGGER ---
        const aiContext = {
            ca: caTotal,
            net: netPoche,
            charges: chargesFixesAnnuelles,
            statut: statut,
            dept: dept,
            assistant: hasAssistant,
            profil: profil,
            secteur: secteur
        };
        updateAIExplanation(aiContext);
    }

    // --- MOTEUR IA EXPLICATIF ---
    function updateAIExplanation(ctx) {
        let messages = [];

        if (ctx.net < 30000) {
            messages.push(
                "Votre revenu estimé est faible pour une installation classique. Cela est souvent lié à un volume d’activité limité ou à des charges fixes élevées."
            );
        }

        if (ctx.net >= 30000 && ctx.net <= 70000) {
            messages.push(
                "Votre résultat correspond à une installation dans la moyenne observée en début ou milieu d’activité."
            );
        }

        if (ctx.net > 70000) {
            messages.push(
                "Votre revenu estimé correspond à une activité soutenue. Il est important de surveiller la charge de travail et l’équilibre personnel."
            );
        }

        if (ctx.assistant) {
            messages.push(
                "La présence d’un assistant médical augmente vos charges mais améliore votre capacité de consultation et votre efficience."
            );
        }

        if (ctx.dept !== "metro") {
            messages.push(
                "Votre localisation ouvre droit à des dispositifs fiscaux et sociaux spécifiques, partiellement intégrés dans la simulation."
            );
        }

        const container = document.getElementById("ai_explanation");
        if(container) {
             container.innerHTML = messages.map(m => `<p>• ${m}</p>`).join("");
        }
    }

    function updateChart(net, ir, social, fixes, redevance, treso, is) {
        const canvas = document.getElementById('financialChart');
        if (!canvas) return;
        const ctx = canvas.getContext('2d');
        if (financeChart) financeChart.destroy();
        let labels = ['Net Poche', 'Impôt IR', 'Social', 'Fixes'];
        let data = [net, ir, social, fixes];
        let colors = ['#10b981', '#3b82f6', '#f97316', '#dc2626'];
        if (redevance > 0) {
            labels.push('Redevance');
            data.push(redevance);
            colors.push('#a855f7');
        }
        if (treso > 0) {
            labels.push('Tréso Soc.');
            data.push(treso);
            colors.push('#059669');
        }
        if (is > 0) {
            labels.push('IS');
            data.push(is);
            colors.push('#6366f1');
        }

        financeChart = new Chart(ctx, {
            type: 'doughnut',
            data: {
                labels,
                datasets: [{
                    data,
                    backgroundColor: colors,
                    borderWidth: 0
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            boxWidth: 10,
                            padding: 10,
                            font: {
                                size: 10
                            }
                        }
                    }
                },
                cutout: '60%'
            }
        });
    }

    // --- UI GLOBAL HANDLERS ---
    window.switchTab = function(tabId) {
        document.querySelectorAll('.tab-content').forEach(el => {
            el.classList.remove('active');
            el.style.display = 'none';
        });
        document.querySelectorAll('.tab-btn').forEach(el => el.classList.remove('active', 'calc-active'));

        const activeTab = document.getElementById('tab-' + tabId);
        if (activeTab) {
            activeTab.classList.add('active');
            activeTab.style.display = 'block';
        }

        const btn = document.getElementById('btn-' + tabId);
        if (btn) {
            if (tabId === 'calculateur') {
                btn.classList.add('calc-active');
                setTimeout(calculate, 50);
            } else if (tabId === 'optimisation') {
                btn.classList.add('active');
                setTimeout(updateOptSim, 50);
            } else {
                btn.classList.add('active');
            }
        }
        updateGlobalProgress();
    };

    window.updateRange = function(id, val) {
        const el = document.getElementById(id);
        if (el) el.innerText = val;
    };

    window.toggleAssistant = function() {
        const box = document.getElementById('assistant_block');
        const chk = document.getElementById('has_assistant');
        if (chk && box) {
            if (chk.checked) box.classList.remove('hidden');
            else box.classList.add('hidden');
        }
        calculate();
    };

    window.toggleFormFields = function() {
        const modeEl = document.getElementById('mode_exercice');
        if (!modeEl) return;
        const statut = modeEl.value;
        const strategyBox = document.getElementById('strategy_card');
        const microBox = document.getElementById('micro_box');
        if (statut === 'selarl' || statut === 'selas') {
            if (strategyBox) strategyBox.classList.remove('hidden');
            if (microBox) microBox.classList.add('hidden');
        } else {
            if (strategyBox) strategyBox.classList.add('hidden');
            if (microBox) microBox.classList.remove('hidden');
            const distrib = document.getElementById('taux_distribution');
            if (distrib) {
                distrib.value = 100;
                updateRange('val_distrib', 100);
            }
        }
    };

    // --- SECTION 7 SIMULATOR ---
    let optChartProj = null;
    let optChartDist = null;

    window.updateOptSim = function() {
        const ca = getOptVal('opt_in_ca') * 1000;
        const chargesPct = getOptVal('opt_in_charges') / 100;
        const remun = getOptVal('opt_in_remun') * 1000;
        const loyer = getOptVal('opt_in_loyer') * 1000;
        const abond = getOptVal('opt_in_abond') * 1000;
        const zfuCheck = document.getElementById('opt_in_zfu');
        const zfu = zfuCheck ? zfuCheck.checked : false;
        const growth = getOptVal('opt_in_croissance') / 100;

        setOptTxt('opt_val_ca', getOptVal('opt_in_ca') + ' k€');
        setOptTxt('opt_val_charges', getOptVal('opt_in_charges') + ' %');
        setOptTxt('opt_val_remun', getOptVal('opt_in_remun') + ' k€');
        setOptTxt('opt_val_loyer', getOptVal('opt_in_loyer') + ' k€');
        setOptTxt('opt_val_abond', getOptVal('opt_in_abond') + ' k€');
        setOptTxt('opt_val_croissance', getOptVal('opt_in_croissance') + ' %');

        const chargesExpl = ca * chargesPct;

        // --- SCENARIO BNC (Classique) ---
        // Charges sociales TNS ~45% du Net Fiscal => ~31% du Super Brut
        const profitBNC = ca - chargesExpl;
        const socialClassique = profitBNC * 0.31; 
        const taxableBNC = profitBNC - socialClassique;
        let irClassique = calculateIR(taxableBNC);
        const reducDOM = Math.min(irClassique * 0.3, 2450); 
        irClassique -= reducDOM;
        const netClassique = taxableBNC - irClassique;

        // --- SCENARIO OPTIMISÉ (SELARL + SPFPL + SCI) ---
        // 1. SCI
        const resultatSCI = loyer * 0.8; 
        const isSCI = calculateIS(resultatSCI);
        const netSCI = resultatSCI - isSCI; 

        // 2. SELARL (TNS)
        const socialOptim = remun * 0.45; 
        const profitSELARL = ca - chargesExpl - loyer - remun - socialOptim - abond;
        
        let baseIS = profitSELARL;
        if(zfu) baseIS = Math.max(0, baseIS - 50000);
        const isSELARL = calculateIS(baseIS);
        const netSELARL = profitSELARL - isSELARL; 

        // 3. Médecin (Perso)
        let irOptim = calculateIR(remun * 0.9); 
        irOptim -= Math.min(irOptim * 0.3, 2450); 
        
        const netRemun = remun - irOptim;
        const netAbond = abond * (1 - 0.097); 
        
        const netOptim = netRemun + netAbond + netSELARL + netSCI;

        // --- UPDATE UI ---
        const totalFiscal = isSCI + isSELARL + irOptim;
        const fiscalClassique = irClassique; // Explicitly define here

        setOptTxt('opt_td_opt_fiscal', fmtOpt(totalFiscal));
        setOptTxt('opt_td_cla_fiscal', fmtOpt(irClassique));
        
        // Gains Table Display Logic
        const gainFiscal = fiscalClassique - totalFiscal;
        setOptTxt('opt_td_diff_fiscal', (gainFiscal >= 0 ? "- " : "+ ") + fmtOpt(Math.abs(gainFiscal)));
        setOptTxt('opt_td_pct_fiscal', (gainFiscal >= 0 ? "-" : "+") + Math.round(Math.abs(gainFiscal/fiscalClassique || 0)*100) + "%");

        setOptTxt('opt_td_opt_social', fmtOpt(socialOptim));
        setOptTxt('opt_td_cla_social', fmtOpt(socialClassique));
        
        const gainSocial = socialClassique - socialOptim;
        setOptTxt('opt_td_diff_social', (gainSocial >= 0 ? "- " : "+ ") + fmtOpt(Math.abs(gainSocial)));
        setOptTxt('opt_td_pct_social', (gainSocial >= 0 ? "-" : "+") + Math.round(Math.abs(gainSocial/socialClassique || 0)*100) + "%");
        
        setOptTxt('opt_td_opt_net', fmtOpt(netOptim));
        setOptTxt('opt_td_cla_net', fmtOpt(netClassique));

        const gainNet = netOptim - netClassique;
        setOptTxt('opt_td_diff_net', (gainNet >= 0 ? "+ " : "") + fmtOpt(gainNet));
        setOptTxt('opt_td_pct_net', (gainNet >= 0 ? "+" : "") + Math.round((gainNet/netClassique || 0)*100) + "%");

        // KPI Cards Display Logic
        const elKpi1 = document.getElementById('opt_kpi_eco_annuelle');
        elKpi1.innerText = (gainNet > 0 ? "+ " : "") + fmtOpt(gainNet);
        elKpi1.className = gainNet >= 0 ? "kpi-value text-green-600" : "kpi-value text-red-600";

        let cumule = 0;
        for(let i=0; i<10; i++) { cumule += gainNet * Math.pow(1.04, i); }
        
        const elKpi2 = document.getElementById('opt_kpi_gain_10ans');
        elKpi2.innerText = (cumule > 0 ? "+ " : "") + fmtOpt(cumule);
        elKpi2.className = cumule >= 0 ? "kpi-value text-blue-600" : "kpi-value text-red-600";
        
        setOptTxt('opt_kpi_taux_retour', Math.round((netOptim / ca) * 100) + "%");
        
        renderOptCharts(
            [totalFiscal, socialOptim, netOptim], 
            [irClassique, socialClassique, netClassique], 
            netOptim, netClassique, growth
        );
    };

    function getOptVal(id) { return parseFloat(document.getElementById(id).value) || 0; }
    function setOptTxt(id, val) { const el = document.getElementById(id); if (el) el.innerText = val; }
    function fmtOpt(num) { return Math.round(num).toLocaleString('fr-FR') + ' €'; }

    function renderOptCharts(dataOpt, dataCla, netOpt, netCla, growth) {
        const projCanvas = document.getElementById('optChartProj');
        if (projCanvas) {
            const ctxProj = projCanvas.getContext('2d');
            if (optChartProj) optChartProj.destroy();
            const labels = Array.from({length: 11}, (_, i) => 2025 + i);
            const seriesOpt = labels.map((_, i) => netOpt * Math.pow(1 + growth, i));
            const seriesCla = labels.map((_, i) => netCla * Math.pow(1 + (growth * 0.8), i));

            optChartProj = new Chart(ctxProj, {
                type: 'line',
                data: {
                    labels: labels,
                    datasets: [{
                        label: 'Optimisé (SELAS+SPFPL)',
                        data: seriesOpt,
                        borderColor: '#007BFF',
                        borderWidth: 3,
                        tension: 0.3,
                        fill: false
                    }, {
                        label: 'Classique (BNC)',
                        data: seriesCla,
                        borderColor: '#dc2626',
                        borderWidth: 2,
                        borderDash: [5, 5],
                        tension: 0.3,
                        fill: false
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });
        }

        const distCanvas = document.getElementById('optChartDist');
        if (distCanvas) {
            const ctxDist = distCanvas.getContext('2d');
            if (optChartDist) optChartDist.destroy();
            optChartDist = new Chart(ctxDist, {
                type: 'bar',
                data: {
                    labels: ['Fiscalité', 'Social', 'NET RETENU'],
                    datasets: [{
                        label: 'Optimisé',
                        data: dataOpt,
                        backgroundColor: '#007BFF',
                        borderRadius: 4
                    }, {
                        label: 'Classique',
                        data: dataCla,
                        backgroundColor: '#ef4444',
                        borderRadius: 4
                    }]
                },
                options: { responsive: true, maintainAspectRatio: false }
            });
        }
    }

    // --- PDF EXPORT FUNCTION (FULL REPORT) ---
    window.exportFullReport = async function() {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pdfWidth = pdf.internal.pageSize.getWidth();
        const pdfHeight = pdf.internal.pageSize.getHeight();

        const addElementToPdf = async (elementId, title) => {
            const element = document.getElementById(elementId);
            if (!element) return;
            const originalDisplay = element.style.display;
            element.style.display = 'block';

            try {
                const canvas = await html2canvas(element, {
                    scale: 2,
                    useCORS: true,
                    logging: false,
                    backgroundColor: '#ffffff'
                });
                const imgData = canvas.toDataURL('image/png');
                const imgHeight = (canvas.height * pdfWidth) / canvas.width;

                if (pdf.internal.getCurrentPageInfo().pageNumber > 1 || pdf.internal.pages.length > 1) {
                    pdf.addPage();
                }

                if (title) {
                    pdf.setFontSize(16);
                    pdf.setTextColor(0, 86, 179);
                    pdf.text(title, 10, 15);
                }
                pdf.addImage(imgData, 'PNG', 0, 20, pdfWidth, imgHeight);
            } catch (err) {
                console.error("Capture failed for " + elementId, err);
            } finally {
                element.style.display = originalDisplay;
            }
        };

        const tabs = document.querySelectorAll('.tab-content');
        tabs.forEach(t => t.style.display = 'none');

        document.getElementById('tab-calculateur').style.display = 'block';
        await new Promise(r => setTimeout(r, 500));
        await addElementToPdf('tab-calculateur', 'Rapport : Simulateur 2025');
        document.getElementById('tab-calculateur').style.display = 'none';

        document.getElementById('tab-optimisation').style.display = 'block';
        await new Promise(r => setTimeout(r, 500));
        await addElementToPdf('tab-optimisation', 'Rapport : Optimisation Fiscale');

        switchTab('optimisation');
        pdf.save('Rapport_Complet_Elodia.pdf');
    };

    window.resetOptSim = function() {
        document.getElementById('opt_in_ca').value = 350;
        document.getElementById('opt_in_charges').value = 40;
        document.getElementById('opt_in_remun').value = 120;
        document.getElementById('opt_in_loyer').value = 20;
        const zfu = document.getElementById('opt_in_zfu');
        if (zfu) zfu.checked = false;
        document.getElementById('opt_in_croissance').value = 3;
        updateOptSim();
    };

    // --- CHECKLIST INTERACTIVE ---
    let checklistProgress = { completed: 0, total: 24 };

    // Function to load checklist state from localStorage
    function loadChecklistState() {
        const savedState = localStorage.getItem('checklistState');
        if (savedState) {
            const state = JSON.parse(savedState);
            const items = document.querySelectorAll('.checklist-item');
            checklistProgress.completed = 0;
            
            items.forEach(item => {
                const id = item.dataset.id;
                if (state[id]) {
                    item.classList.add('completed');
                    item.style.backgroundColor = '#f0fdf4';
                    const icon = item.querySelector('.ph-check');
                    const badge = item.querySelector('.checklist-icon');
                    if (icon) icon.style.color = '#22c55e';
                    if (badge) badge.style.backgroundColor = '#22c55e';
                    checklistProgress.completed++;
                }
            });
            updateChecklistProgress();
            updatePhaseCounters();
        }
    }

    // Function to save checklist state to localStorage
    function saveChecklistState() {
        const state = {};
        document.querySelectorAll('.checklist-item').forEach(item => {
            if (item.classList.contains('completed')) {
                state[item.dataset.id] = true;
            }
        });
        localStorage.setItem('checklistState', JSON.stringify(state));
    }

    window.toggleChecklistItem = function(element) {
        const isCompleted = element.classList.contains('completed');
        const icon = element.querySelector('.ph-check');
        const badge = element.querySelector('.checklist-icon');

        if (isCompleted) {
            element.classList.remove('completed');
            element.style.backgroundColor = '';
            if (icon) icon.style.color = '#94a3b8';
            if (badge) badge.style.backgroundColor = '#94a3b8';
            checklistProgress.completed--;
        } else {
            element.classList.add('completed');
            element.style.backgroundColor = '#f0fdf4';
            if (icon) icon.style.color = '#22c55e';
            if (badge) badge.style.backgroundColor = '#22c55e';
            checklistProgress.completed++;
        }

        saveChecklistState(); // Save state on toggle
        updateChecklistProgress();
        updatePhaseCounters();
    };

    function updateChecklistProgress() {
        const percentage = Math.round((checklistProgress.completed / checklistProgress.total) * 100);
        const pb = document.getElementById('checklist-progress-bar');
        if (pb) pb.style.width = percentage + '%';
        const pt = document.getElementById('checklist-progress-text');
        if (pt) pt.textContent = `${percentage}% (${checklistProgress.completed}/${checklistProgress.total})`;
        
        const fill = document.getElementById('progress-fill');
        if (fill) fill.style.width = percentage + '%';
        const txt = document.getElementById('progress-text');
        if (txt) txt.textContent = percentage + '%';
    }

    function updatePhaseCounters() {
        // Use more robust counting based on parent container IDs
        const phases = [
            { id: 'checklist-phase-1', target: 'phase1-count', total: 6 },
            { id: 'checklist-phase-2', target: 'phase2-count', total: 8 },
            { id: 'checklist-phase-3', target: 'phase3-count', total: 6 },
            { id: 'checklist-phase-4', target: 'phase4-count', total: 4 }
        ];

        phases.forEach(phase => {
            const container = document.getElementById(phase.id);
            if (container) {
                const completedCount = container.querySelectorAll('.checklist-item.completed').length;
                const targetEl = document.getElementById(phase.target);
                if (targetEl) {
                    targetEl.textContent = `${completedCount}/${phase.total}`;
                }
            }
        });
    }

    window.resetChecklist = function() {
        document.querySelectorAll('.checklist-item').forEach(item => {
            item.classList.remove('completed');
            item.style.backgroundColor = '';
            const check = item.querySelector('.ph-check');
            const icon = item.querySelector('.checklist-icon');
            if (check) check.style.color = '#94a3b8';
            if (icon) icon.style.backgroundColor = '#94a3b8';
        });
        checklistProgress.completed = 0;
        localStorage.removeItem('checklistState'); // Clear storage
        updateChecklistProgress();
        updatePhaseCounters();
    };

    window.exportChecklistPDF = async function() {
        const { jsPDF } = window.jspdf;
        const pdf = new jsPDF('p', 'mm', 'a4');
        const pdfWidth = pdf.internal.pageSize.getWidth();
        
        const element = document.getElementById('tab-checklist');
        
        // Hide buttons for cleaner PDF
        const buttons = element.querySelectorAll('button');
        buttons.forEach(btn => btn.style.display = 'none');
        
        try {
            const canvas = await html2canvas(element, {
                scale: 2,
                useCORS: true,
                logging: false,
                backgroundColor: '#ffffff'
            });
            
            const imgData = canvas.toDataURL('image/png');
            const imgHeight = (canvas.height * pdfWidth) / canvas.width;
            
            pdf.setFontSize(16);
            pdf.setTextColor(0, 86, 179);
            pdf.text("Checklist d'Installation - Suivi", 10, 15);
            
            pdf.addImage(imgData, 'PNG', 0, 20, pdfWidth, imgHeight);
            pdf.save('Checklist_Installation_Elodia.pdf');
            
        } catch (err) {
            console.error("Export PDF failed", err);
            alert("Erreur lors de l'export PDF");
        } finally {
            // Restore buttons
            buttons.forEach(btn => btn.style.display = '');
        }
    };

    function updateGlobalProgress() {
        const activeTab = document.querySelector('.tab-content.active');
        if (activeTab && activeTab.id === 'tab-checklist') {
            const percentage = Math.round((checklistProgress.completed / checklistProgress.total) * 100);
            document.getElementById('progress-fill').style.width = percentage + '%';
            document.getElementById('progress-text').textContent = percentage + '%';
        } else {
            const tabButtons = document.querySelectorAll('.tab-btn');
            const activeButton = document.querySelector('.tab-btn.active, .tab-btn.calc-active');
            const activeIndex = Array.from(tabButtons).indexOf(activeButton);
            const percentage = Math.round(((activeIndex + 1) / tabButtons.length) * 100);
            document.getElementById('progress-fill').style.width = percentage + '%';
            document.getElementById('progress-text').textContent = percentage + '%';
        }
    }

    // Init
    window.addEventListener('load', () => {
        toggleFormFields();
        calculate();
        updateOptSim();
        loadChecklistState(); // Load saved state
        updateChecklistProgress();
        updatePhaseCounters();
        updateGlobalProgress();
    });
  </script></body></html>
